<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.185">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Telling Stories with Data - 3&nbsp; R essentials</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>

  <script src="site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="./">
  <script src="site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="site_libs/quarto-search/fuse.min.js"></script>
  <script src="site_libs/quarto-search/quarto-search.js"></script>
  <link href="./04-workflow.html" rel="next">
  <link href="./02-drinking_from_a_fire_hose.html" rel="prev">
  <script src="site_libs/quarto-html/quarto.js"></script>
  <script src="site_libs/quarto-html/popper.min.js"></script>
  <script src="site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="site_libs/quarto-html/anchor.min.js"></script>
  <link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "sidebar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "start",
    "type": "textbox",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="floating">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R essentials</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Telling Stories with Data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RohanAlexander/telling_stories/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-author.html" class="sidebar-item-text sidebar-link">About the author</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Foundations</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Telling stories with data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-drinking_from_a_fire_hose.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Drinking from a fire hose</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-r_essentials.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R essentials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-workflow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Communication</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-on_writing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">On writing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-static_communication.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Static communication</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-interactive_communication.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Interactive communication</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Acquisition</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-farm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Farm data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-gather.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Gather data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-hunt.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hunt data</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Preparation</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-clean_and_prepare.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Clean and prepare</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-store_and_share.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Store and share</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Modelling</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-ijalm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">It’s Just A Linear Model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-causality_from_obs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Causality from observational data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-mrp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Multilevel regression with post-stratification</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-text.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Text as data</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Enrichment</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-deploy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Deploying models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-efficiency.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Efficiency</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-concluding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Concluding remarks</span></a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Appendices</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-assessment.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Papers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-cocktails.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Cocktails</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background"> <span class="header-section-number">3.1</span> Background</a></li>
<li><a href="#broader-impacts" id="toc-broader-impacts" class="nav-link" data-scroll-target="#broader-impacts"> <span class="header-section-number">3.2</span> Broader impacts</a></li>
<li><a href="#r-r-studio-and-r-studio-cloud" id="toc-r-r-studio-and-r-studio-cloud" class="nav-link" data-scroll-target="#r-r-studio-and-r-studio-cloud"> <span class="header-section-number">3.3</span> R, R Studio, and R Studio Cloud</a>
<ul class="collapse">
<li><a href="#r" id="toc-r" class="nav-link" data-scroll-target="#r"> <span class="header-section-number">3.3.1</span> R</a></li>
<li><a href="#r-studio" id="toc-r-studio" class="nav-link" data-scroll-target="#r-studio"> <span class="header-section-number">3.3.2</span> R Studio</a></li>
<li><a href="#r-studio-cloud" id="toc-r-studio-cloud" class="nav-link" data-scroll-target="#r-studio-cloud"> <span class="header-section-number">3.3.3</span> R Studio Cloud</a></li>
</ul></li>
<li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"> <span class="header-section-number">3.4</span> Getting started</a></li>
<li><a href="#the-dplyr-verbs" id="toc-the-dplyr-verbs" class="nav-link" data-scroll-target="#the-dplyr-verbs"> <span class="header-section-number">3.5</span> The <code>dplyr</code> verbs</a>
<ul class="collapse">
<li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"> <span class="header-section-number">3.5.1</span> <code>select()</code></a></li>
<li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"> <span class="header-section-number">3.5.2</span> <code>filter()</code></a></li>
<li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"> <span class="header-section-number">3.5.3</span> <code>arrange()</code></a></li>
<li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate"> <span class="header-section-number">3.5.4</span> <code>mutate()</code></a></li>
<li><a href="#summarise" id="toc-summarise" class="nav-link" data-scroll-target="#summarise"> <span class="header-section-number">3.5.5</span> <code>summarise()</code></a></li>
</ul></li>
<li><a href="#base" id="toc-base" class="nav-link" data-scroll-target="#base"> <span class="header-section-number">3.6</span> Base</a>
<ul class="collapse">
<li><a href="#class" id="toc-class" class="nav-link" data-scroll-target="#class"> <span class="header-section-number">3.6.1</span> <code>class()</code></a></li>
<li><a href="#simulating-data" id="toc-simulating-data" class="nav-link" data-scroll-target="#simulating-data"> <span class="header-section-number">3.6.2</span> Simulating data</a></li>
<li><a href="#function-for-and-apply" id="toc-function-for-and-apply" class="nav-link" data-scroll-target="#function-for-and-apply"> <span class="header-section-number">3.6.3</span> <code>function()</code>, <code>for()</code>, and <code>apply()</code></a></li>
</ul></li>
<li><a href="#making-graphs-with-ggplot2" id="toc-making-graphs-with-ggplot2" class="nav-link" data-scroll-target="#making-graphs-with-ggplot2"> <span class="header-section-number">3.7</span> Making graphs with <code>ggplot2</code></a></li>
<li><a href="#exploring-the-tidyverse" id="toc-exploring-the-tidyverse" class="nav-link" data-scroll-target="#exploring-the-tidyverse"> <span class="header-section-number">3.8</span> Exploring the <code>tidyverse</code></a>
<ul class="collapse">
<li><a href="#importing-data-and-tibble" id="toc-importing-data-and-tibble" class="nav-link" data-scroll-target="#importing-data-and-tibble"> <span class="header-section-number">3.8.1</span> Importing data and <code>tibble()</code></a></li>
<li><a href="#dataset-manipulation-with-joins-and-pivots" id="toc-dataset-manipulation-with-joins-and-pivots" class="nav-link" data-scroll-target="#dataset-manipulation-with-joins-and-pivots"> <span class="header-section-number">3.8.2</span> Dataset manipulation with joins and pivots</a></li>
<li><a href="#string-manipulation-and-stringr" id="toc-string-manipulation-and-stringr" class="nav-link" data-scroll-target="#string-manipulation-and-stringr"> <span class="header-section-number">3.8.3</span> String manipulation and <code>stringr</code></a></li>
<li><a href="#factor-variables-and-forcats" id="toc-factor-variables-and-forcats" class="nav-link" data-scroll-target="#factor-variables-and-forcats"> <span class="header-section-number">3.8.4</span> Factor variables and <code>forcats</code></a></li>
</ul></li>
<li><a href="#exercises-and-tutorial" id="toc-exercises-and-tutorial" class="nav-link" data-scroll-target="#exercises-and-tutorial"> <span class="header-section-number">3.9</span> Exercises and tutorial</a>
<ul class="collapse">
<li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"> <span class="header-section-number">3.9.1</span> Exercises</a></li>
<li><a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial"> <span class="header-section-number">3.9.2</span> Tutorial</a></li>
</ul></li>
</ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/RohanAlexander/telling_stories/edit/main/03-r_essentials.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">

<div class="quarto-title"><h1 class="title display-7"><span id="sec-r-essentials" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R essentials</span></span></h1></div></header>

<p><strong>Required material</strong></p>
<ul>
<li>Read <em>The Kitchen Counter Observatory</em>, <span class="citation" data-cites="kieranskitchen">(<a href="references.html#ref-kieranskitchen" role="doc-biblioref">Healy 2020</a>)</span></li>
<li>Read <em>R for Data Science</em>, Chapter 5 ‘Data transformation’, <span class="citation" data-cites="r4ds">(<a href="references.html#ref-r4ds" role="doc-biblioref">Wickham and Grolemund 2017</a>)</span></li>
<li>Read <em>Data Feminism</em>, Chapter 6 ‘The Numbers Don’t Speak for Themselves’, <span class="citation" data-cites="datafeminism2020">(<a href="references.html#ref-datafeminism2020" role="doc-biblioref">D’Ignazio and Klein 2020</a>)</span></li>
<li>Read <em>R generation</em>, <span class="citation" data-cites="Thieme2018">(<a href="references.html#ref-Thieme2018" role="doc-biblioref">Thieme 2018</a>)</span></li>
</ul>
<p><strong>Key concepts and skills</strong></p>
<ul>
<li>Understanding foundational aspects of R and R Studio.</li>
<li>Being able to use key <code>dplyr</code> verbs.</li>
<li>Know fundamentals of class and how to manipulate it.</li>
<li>Ability to simulate data.</li>
<li>Ability to make graphs in <code>ggplot2</code>.</li>
<li>Comfort with other aspects of the <code>tidyverse</code> including importing data, dataset manipulation, string manipulation, and factors.</li>
<li>Develop strategies for when things do not work.</li>
</ul>
<p><strong>Key libraries</strong></p>
<ul>
<li><code>forcats</code> <span class="citation" data-cites="citeforcats">(<a href="references.html#ref-citeforcats" role="doc-biblioref">Wickham 2020a</a>)</span></li>
<li><code>ggplot2</code> <span class="citation" data-cites="citeggplot">(<a href="references.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span></li>
<li><code>haven</code> <span class="citation" data-cites="citehaven">(<a href="references.html#ref-citehaven" role="doc-biblioref">Wickham and Miller 2020</a>)</span></li>
<li><code>stringr</code> <span class="citation" data-cites="citestringr">(<a href="references.html#ref-citestringr" role="doc-biblioref">Wickham 2019b</a>)</span></li>
<li><code>tidyr</code> <span class="citation" data-cites="citetidyr">(<a href="references.html#ref-citetidyr" role="doc-biblioref">Wickham 2021</a>)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="citetidyverse">(<a href="references.html#ref-citetidyverse" role="doc-biblioref">Wickham et al. 2019a</a>)</span></li>
</ul>
<p><strong>Key functions</strong></p>
<ul>
<li><code>|</code> ‘or’</li>
<li><code>&amp;</code> ‘and’</li>
<li><code>|&gt;</code> ‘pipe’</li>
<li><code>$</code> ‘extract’</li>
<li><code>as.character()</code></li>
<li><code>as.integer()</code></li>
<li><code>c()</code></li>
<li><code>citation()</code></li>
<li><code>class()</code></li>
<li><code>dplyr::arrange()</code></li>
<li><code>dplyr::case_when()</code></li>
<li><code>dplyr::count()</code></li>
<li><code>dplyr::filter()</code></li>
<li><code>dplyr::group_by()</code></li>
<li><code>dplyr::if_else()</code></li>
<li><code>dplyr::left_join()</code></li>
<li><code>dplyr::mutate()</code></li>
<li><code>dplyr::pull()</code></li>
<li><code>dplyr::rename()</code></li>
<li><code>dplyr::select()</code></li>
<li><code>dplyr::slice()</code></li>
<li><code>dplyr::summarise()</code></li>
<li><code>forcats::as_factor()</code></li>
<li><code>forcats::fct_relevel()</code></li>
<li><code>function()</code></li>
<li><code>ggplot2::facet_wrap()</code></li>
<li><code>ggplot2::geom_density()</code></li>
<li><code>ggplot2::geom_histogram()</code></li>
<li><code>ggplot2::geom_point()</code></li>
<li><code>ggplot2::ggplot()</code></li>
<li><code>head()</code></li>
<li><code>janitor::clean_names()</code></li>
<li><code>library()</code></li>
<li><code>lubridate::ymd()</code></li>
<li><code>max()</code></li>
<li><code>mean()</code></li>
<li><code>print()</code></li>
<li><code>readr::read_csv()</code></li>
<li><code>rnorm()</code></li>
<li><code>round()</code></li>
<li><code>runif()</code></li>
<li><code>sample()</code></li>
<li><code>set.seed()</code></li>
<li><code>stringr::str_detect()</code></li>
<li><code>stringr::str_replace()</code></li>
<li><code>stringr::str_squish()</code></li>
<li><code>sum()</code></li>
<li><code>tibble::tibble()</code></li>
<li><code>tidyr::pivot_longer()</code></li>
<li><code>tidyr::pivot_wider()</code></li>
</ul>
<section id="background" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="background"><span class="header-section-number">3.1</span> Background</h2>
<p>In this chapter we focus on foundational skills needed to use the statistical programming language R <span class="citation" data-cites="citeR">(<a href="references.html#ref-citeR" role="doc-biblioref">R Core Team 2021</a>)</span> to tell stories with data. Some of it may not make sense at first, but these are skills and approaches that we will often use. You should initially just go through this chapter quickly, noting aspects that you do not understand. And then come back to this chapter from time to time as you continue through the rest of the book. That way you will see how the various bits fit into context.</p>
<p>R is an open-source language for statistical programming. You can download R for free from the <a href="https://cran.r-project.org">Comprehensive R Archive Network</a> (CRAN). R Studio is an Integrated Development Environment (IDE) for R which makes the language easier to use and can be downloaded for free from <a href="https://www.rstudio.com/products/rstudio/">R Studio</a>.</p>
<p>The past ten years or so have been characterized by the increased use of the <code>tidyverse</code>. This is ‘…an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures’ <span class="citation" data-cites="tidyversewebsite">(<a href="references.html#ref-tidyversewebsite" role="doc-biblioref">Wickham 2020b</a>)</span>. There are three distinctions to be clear about: the original R language, typically referred to as ‘base’; the ‘tidyverse’ which is a coherent collection of packages that build on top of base, and other packages.</p>
<p>Essentially everything that we can do in the tidyverse, we can also do in base. But, as the <code>tidyverse</code> was built especially for data science it is often easier to use the tidyverse, especially when learning. Additionally, often everything that we can do in the tidyverse, we can also do with other packages. But, as the <code>tidyverse</code> is a coherent collection of packages, it is often easier to use the tidyverse, again, especially when learning. Eventually there are cases where it makes sense to trade-off the convenience and coherence of the <code>tidyverse</code> for some features of base or other packages. Indeed, we will see that at various points later in this book. For instance, the <code>tidyverse</code> can be slow, and so if one needs to import thousands of CSVs then it can make sense to switch away from <code>read_csv()</code>. The appropriate use of base and non-tidyverse packages, or even other languages, rather than dogmatic insistence on a particular solution, is a sign of intellectual maturity.</p>
<p>Central to our use of the statistical programming language R is data, and most of the data that we use will have humans at the heart of it. Sometimes, dealing with human-centered data in this way can have a numbing effect, resulting in over-generalization, and potentially problematic work. Another sign of intellectual maturity is when it has the opposite effect, increasing our awareness of our decision-making processes and their consequences.</p>
<blockquote class="blockquote">
<p>In practice, I find that far from distancing you from questions of meaning, quantitative data forces you to confront them. The numbers draw you in. Working with data like this is an unending exercise in humility, a constant compulsion to think through what you can and cannot see, and a standing invitation to understand what the measures really capture—what they mean, and for whom.</p>
<p><span class="citation" data-cites="kieranskitchen">Healy (<a href="references.html#ref-kieranskitchen" role="doc-biblioref">2020</a>)</span></p>
</blockquote>
</section>
<section id="broader-impacts" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="broader-impacts"><span class="header-section-number">3.2</span> Broader impacts</h2>
<blockquote class="blockquote">
<p>“We shouldn’t have to think about the societal impact of our work because it’s hard and other people can do it for us” is a really bad argument. I stopped doing CV [computer vision] research because I saw the impact my work was having. I loved the work but the military applications and privacy concerns eventually became impossible to ignore. But basically all facial recognition work would not get published if we took Broader Impacts sections seriously. There is almost no upside and enormous downside risk. To be fair though I should have a lot of humility here. For most of grad school I bought in to the myth that science is apolitical and research is objectively moral and good no matter what the subject is.</p>
<p>Joe Redmon, 20 February 2020</p>
</blockquote>
<p>Although the term ‘data science’ is ubiquitous in academia, industry, and even more generally, it is difficult to define. One deliberately antagonistic definition of data science is ‘[t]he inhumane reduction of humanity down to what can be counted’ <span class="citation" data-cites="keyes2019">(<a href="references.html#ref-keyes2019" role="doc-biblioref">Keyes 2019</a>)</span>. While purposefully controversial, this definition highlights one reason for the increased demand for data science and quantitative methods over the past decade—individuals and their behavior are now at the heart of it. Many of the techniques have been around for many decades, but what makes them popular now is this human focus.</p>
<p>Unfortunately, even though much of the work may be focused on individuals, the issues of privacy and consent, and ethical concerns more broadly, rarely seem front of mind. While there are some exceptions, in general, even at the same time as claiming that AI, machine learning, and data science are going to revolutionize society, consideration of these types of issues appears to have been largely treated as something that would be nice to have, rather than something that we may like to think of before we embrace the revolution.</p>
<p>For the most part, these types of issues are not new. In the sciences, there has been considerable recent ethical consideration around CRISPR technology and gene editing <span class="citation" data-cites="brokowski2019crispr">(<a href="references.html#ref-brokowski2019crispr" role="doc-biblioref">Brokowski and Adli 2019</a>)</span>, but in an earlier time similar conversations were had, for instance, about Wernher von Braun being allowed to building rockets for the US <span class="citation" data-cites="neufeld2002wernher">(<a href="references.html#ref-neufeld2002wernher" role="doc-biblioref">Neufeld 2002</a>)</span>. In medicine, of course, these concerns have been front-of-mind for some time <span class="citation" data-cites="american1848code">(<a href="references.html#ref-american1848code" role="doc-biblioref">Association and Medicine 1848</a>)</span>. Data science seems determined to have its own Tuskegee-moment rather than think about, and proactively address with, these issues based on the experiences of other fields.</p>
<p>That said, there is some evidence that data scientists are beginning to be more concerned about the ethics surrounding the practice. For instance, NeurIPS, a prestigious machine learning conference, has required a statement on ethics to accompany all submissions since 2020.</p>
<blockquote class="blockquote">
<p>In order to provide a balanced perspective, authors are required to include a statement of the potential broader impact of their work, including its ethical aspects and future societal consequences. Authors should take care to discuss both positive and negative outcomes.</p>
<p>NeurIPS 2020 Conference Call For Papers</p>
</blockquote>
<p>The purpose of ethical consideration and concern for the broader impact of data science is not to prescriptively rule things in or out, but to provide an opportunity to raise some issues that should be paramount. The variety of data science applications, the relative youth of the field, and the speed of change, mean that such considerations are sometimes knowingly set aside, and this is acceptable to the rest of the field. This contrasts with fields such as science, medicine, engineering, and accounting. Possibly those fields are more self-aware (<a href="#fig-personalprobability">Figure&nbsp;<span>3.1</span></a>).</p>
<div id="fig-personalprobability" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/probability.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3.1: <a href="https://xkcd.com/881/">Probability</a>, from Randall Munroe’s XKCD.</figcaption><p></p>
</figure>
</div>
</section>
<section id="r-r-studio-and-r-studio-cloud" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="r-r-studio-and-r-studio-cloud"><span class="header-section-number">3.3</span> R, R Studio, and R Studio Cloud</h2>
<p>R and R Studio are complementary, but they are not the same thing. Dr Liza Bolton, Assistant Professor, Teaching Stream, University of Toronto, explains their relationship by analogy where R is like the engine and R Studio is like the car. Although some of us use a car engine directly, most of us use a car to interact with the engine.</p>
<section id="r" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="r"><span class="header-section-number">3.3.1</span> R</h3>
<p><a href="https://www.r-project.org/">R</a> is an open-source and free programming language that is focused on general statistics. Free in this context does not refer to a price of zero, but instead to the freedom that the creators give users to largely do what they want with it (although it also does have a price of zero). This is in contrast with an open-source programming language that is designed for general purpose, such as Python, or an open-source programming language that is focused on probability, such as Stan. It was created by Ross Ihaka and Robert Gentleman at the University of Auckland in the 1990s, and traces its provenance to S, which was developed at Bell Labs in the 1970s. It is maintained by the R Core Team and changes to this ‘base’ of code occur methodically and with concern given to a variety of different priorities.</p>
<p>Many people build on this stable base, to extend the capabilities of R to better and more quickly suit their needs. They do this by creating packages. Typically, although not always, a package is a collection of R code, mostly functions, and this allows us to more easily do things that we want to do. These packages are managed by repositories such as CRAN and Bioconductor.</p>
<p>If you want to use a package then you first need to install it on your computer, and then you need to load it when you want to use it. Dr.&nbsp;Di Cook, Professor of Business Analytics at Monash University, describes this as analogous to a lightbulb. If you want light in your house, first you need to fit a lightbulb, and then you need to turn the switch on. Installing a package, say, <code>install.packages("tidyverse")</code>, is akin to fitting a lightbulb into a socket—you only need to do this once for each lightbulb. But then each time you want light you need to turn on the switch to the lightbulb, which in the R packages case, means calling the library, say, <code>library(tidyverse)</code>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Shoulders of giants
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dr Di Cook is Professor of Business Analytics at Monash University. After taking a PhD in statistics from Rutgers University in 1993 where she focused on statistical graphics, she was appointed as an assistant professor at Iowa State University, being promoted to full professor in 2005, and in 2015 she moved to Monash. One area of her research is data visualisation, especially interactive and dynamic graphics. One particularly important paper is <span class="citation" data-cites="buja1996interactive">Buja, Cook, and Swayne (<a href="references.html#ref-buja1996interactive" role="doc-biblioref">1996</a>)</span> which proposes a taxonomy of interactive data visualization and associated software XGobi.</p>
</div>
</div>
<p>To install a package on your computer (again, we will need to do this only once per computer) we use <code>install.packages()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And then when we want to use the package, we use <code>library()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Having downloaded it, we can open R and use it directly. It is primarily designed to be interacted with through the command line. While this is functional, it can be useful to have a richer environment than the command line provides. In particular, it can be useful to install an Integrated Development Environment (IDE), which is an application that brings together various bits and pieces that will be used often. One common IDE for R is R Studio, although others such as Visual Studio are also used.</p>
</section>
<section id="r-studio" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="r-studio"><span class="header-section-number">3.3.2</span> R Studio</h3>
<p>R Studio is distinct to R, and they are different entities. R Studio builds on top of R to make it easier to use R. This is in the same way that one could use the internet from the command line, but most folks use a browser such as Chrome, Firefox, or Safari.</p>
<p>R Studio is free in the sense that we do not pay for it. It is also free in the sense of being able to take the code, modify it, and distribute that code. But it is important to recognize that R Studio is a company and so it is possible that the current situation could change. It can be downloaded from <a href="https://www.rstudio.com/products/rstudio/">R Studio</a>.</p>
<p>When we open R Studio it will look like <a href="#fig-first">Figure&nbsp;<span>3.2</span></a>.</p>
<div id="fig-first" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/01.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3.2: Opening R Studio for the first time</figcaption><p></p>
</figure>
</div>
<p>The left pane is a console in which you can type and execute R code line by line. Try it with 2+2 by clicking next to the prompt ‘&gt;’, typing ‘2+2’, and then pressing ‘return/enter’.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>The pane on the top right has information about your environment. For instance, when we create variables a list of their names and some properties will appear there. Try to type the following code, replacing my name with your name, next to the prompt, and again press enter:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my_name <span class="ot">&lt;-</span> <span class="st">"Rohan"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You should notice a new value in the environment pane with the variable name and its value.</p>
<p>The pane in the bottom right is a file manager. At the moment it should just have two files: an R History file and a R Project file. We will get to what these are later, but for now we will create and save a file.</p>
<p>Run the following code, without worrying too much about the details for now. And you should see a new ‘.rds’ file in your list of files.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(<span class="at">object =</span> my_name, <span class="at">file =</span> <span class="st">"my_first_file.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-studio-cloud" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="r-studio-cloud"><span class="header-section-number">3.3.3</span> R Studio Cloud</h3>
<p>While you can and should download R Studio to your own computer, initially we will use <a href="https://rstudio.cloud/">R Studio Cloud</a>. This is an online version that is provided by R Studio. We will use this so that you can focus on getting comfortable with R and R Studio in an environment that is consistent. This way you do not have to worry about what computer you have or installation permissions, amongst other things.</p>
<p>The free version of R Studio Cloud is free as is ‘no financial cost’. The trade-off is that it is not very powerful, and it is sometimes slow, but for the purposes of getting started it is enough.</p>
</section>
</section>
<section id="getting-started" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">3.4</span> Getting started</h2>
<p>We will now start going through some code. It is important to actively write this all out yourself.</p>
<p>While working line-by-line in the console is fine, it is easier to write out a whole script that can then be run. We will do this by making an R Script (‘File’ -&gt; ‘New File’ -&gt; ‘R Script’). The console pane will fall to the bottom left and an R Script will open in the top left. We will write some code that will get all of the Australian federal politicians and then construct a small table about the genders of the prime ministers. Some of this code will not make sense at this stage, but just type it all out to get in the habit and then run it. To run the whole script, we can click ‘Run’ or we can highlight certain lines and then click ‘Run’ to just run those lines.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the packages that we need</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"AustralianPoliticians"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages that we need to use this time</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AustralianPoliticians)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a table of the counts of genders of the prime ministers</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>AustralianPoliticians<span class="sc">::</span><span class="fu">get_auspol</span>(<span class="st">'all'</span>) <span class="sc">|&gt;</span> <span class="co"># Imports data from GitHub</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wasPrimeMinister <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 2
  gender     n
  &lt;chr&gt;  &lt;int&gt;
1 female     1
2 male      29</code></pre>
</div>
</div>
<p>We can see that, as at the end of 2021, one female has been prime minister (Julia Gillard), while the other 29 prime ministers were male.</p>
<p>One critical operator when programming is the ‘pipe’: <code>|&gt;</code>. We read this as ‘and then’. This takes the output of a line of code and uses it as the first input to the next line of code. It makes code easier to read.</p>
<p>The idea of the pipe is that we take a dataset, and then do something to it. We used this in the earlier example. Another example follows where we will look at the first six lines of a dataset by piping it to <code>head()</code>. Notice that <code>head()</code> does not explicitly take any arguments in this example. It knows which data to display because the pipe does it implicitly.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>AustralianPoliticians<span class="sc">::</span><span class="fu">get_auspol</span>(<span class="st">'all'</span>) <span class="sc">|&gt;</span> <span class="co"># Imports data from GitHub</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 20
  uniqueID   surname allOtherNames          firstName commonName displayName    
  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;                  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;          
1 Abbott1859 Abbott  Richard Hartley Smith  Richard   &lt;NA&gt;       Abbott, Richard
2 Abbott1869 Abbott  Percy Phipps           Percy     &lt;NA&gt;       Abbott, Percy  
3 Abbott1877 Abbott  Macartney              Macartney Mac        Abbott, Mac    
4 Abbott1886 Abbott  Charles Lydiard Aubrey Charles   Aubrey     Abbott, Aubrey 
5 Abbott1891 Abbott  Joseph Palmer          Joseph    &lt;NA&gt;       Abbott, Joseph 
6 Abbott1957 Abbott  Anthony John           Anthony   Tony       Abbott, Tony   
# … with 14 more variables: earlierOrLaterNames &lt;chr&gt;, title &lt;chr&gt;,
#   gender &lt;chr&gt;, birthDate &lt;date&gt;, birthYear &lt;dbl&gt;, birthPlace &lt;chr&gt;,
#   deathDate &lt;date&gt;, member &lt;dbl&gt;, senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;,
#   wikidataID &lt;chr&gt;, wikipedia &lt;chr&gt;, adb &lt;chr&gt;, comments &lt;chr&gt;</code></pre>
</div>
</div>
<p>We can save this R Script as ‘my_first_r_script.R’ (‘File’ -&gt; ‘Save As’). At this point, our workspace should look something like <a href="#fig-third">Figure&nbsp;<span>3.3</span></a>.</p>
<div id="fig-third" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figures/03.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3.3: After running an R Script</figcaption><p></p>
</figure>
</div>
<p>One thing to be aware of is that each R Studio Cloud workspace is essentially a new computer. Because of this, we need to install any package that we want to use for each workspace. For instance, before we can use the <code>tidyverse</code>, we need to install it with <code>install.packages("tidyverse")</code>. This contrasts with using one’s own computer.</p>
<p>A few final notes on R Studio Cloud:</p>
<ol type="1">
<li>In the Australian politician’s example, we got our data from the website GitHub using an R package, but we can get data into a workspace from a local computer in a variety of ways. One way is to use the ‘upload’ button in the ‘Files’ panel.</li>
<li>R Studio Cloud allows some degree of collaboration. For instance, you can give someone else access to a workspace that you create. This could be useful for collaborating on an assignment, although it is not quite full featured yet and you cannot both be in the workspace at the same time, in contrast to Google Docs, for example.</li>
<li>There are a variety of weaknesses of R Studio Cloud, in particular the RAM limits. Additionally, like any web application, things break from time to time or go down.</li>
</ol>
</section>
<section id="the-dplyr-verbs" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="the-dplyr-verbs"><span class="header-section-number">3.5</span> The <code>dplyr</code> verbs</h2>
<p>One of the key packages that we will use is the <code>tidyverse</code> <span class="citation" data-cites="tidyverse">(<a href="references.html#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019b</a>)</span>. The <code>tidyverse</code> is actually a package of packages, which means when we install the <code>tidyverse</code>, we actually install a whole bunch of different packages. The key package in the <code>tidyverse</code> in terms of manipulating data is <code>dplyr</code> <span class="citation" data-cites="citedplyr">(<a href="references.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>.</p>
<p>There are five <code>dplyr</code> functions that are regularly used, and we will now go through each of these. These are commonly referred to as the <code>dplyr</code> verbs.</p>
<ol type="1">
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>arrange()</code></li>
<li><code>mutate()</code></li>
<li><code>summarise()</code> or equally <code>summarize()</code></li>
</ol>
<p>We will also cover <code>group_by()</code>, and <code>count()</code> here as they are closely related.</p>
<p>As we have already installed the <code>tidyverse</code>, we just need to load it.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we will begin by again using some data about Australian politicians from the <code>AustralianPoliticians</code> package <span class="citation" data-cites="citeaustralianpoliticians">(<a href="references.html#ref-citeaustralianpoliticians" role="doc-biblioref">Alexander and Hodgetts 2021</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AustralianPoliticians)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="ot">&lt;-</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_auspol</span>(<span class="st">'all'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(australian_politicians)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 20
  uniqueID   surname allOtherNames          firstName commonName displayName    
  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;                  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;          
1 Abbott1859 Abbott  Richard Hartley Smith  Richard   &lt;NA&gt;       Abbott, Richard
2 Abbott1869 Abbott  Percy Phipps           Percy     &lt;NA&gt;       Abbott, Percy  
3 Abbott1877 Abbott  Macartney              Macartney Mac        Abbott, Mac    
4 Abbott1886 Abbott  Charles Lydiard Aubrey Charles   Aubrey     Abbott, Aubrey 
5 Abbott1891 Abbott  Joseph Palmer          Joseph    &lt;NA&gt;       Abbott, Joseph 
6 Abbott1957 Abbott  Anthony John           Anthony   Tony       Abbott, Tony   
# … with 14 more variables: earlierOrLaterNames &lt;chr&gt;, title &lt;chr&gt;,
#   gender &lt;chr&gt;, birthDate &lt;date&gt;, birthYear &lt;dbl&gt;, birthPlace &lt;chr&gt;,
#   deathDate &lt;date&gt;, member &lt;dbl&gt;, senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;,
#   wikidataID &lt;chr&gt;, wikipedia &lt;chr&gt;, adb &lt;chr&gt;, comments &lt;chr&gt;</code></pre>
</div>
</div>
<section id="select" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="select"><span class="header-section-number">3.5.1</span> <code>select()</code></h3>
<p>We use <code>select()</code> to pick particular columns of a dataset. For instance, we might like to select the ‘firstName’ column.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(firstName) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 1
  firstName
  &lt;chr&gt;    
1 Richard  
2 Percy    
3 Macartney
4 Charles  
5 Joseph   
6 Anthony  </code></pre>
</div>
</div>
<p>In R, there are many ways to do things. Sometimes these are different ways to do the same thing, and other times they are different ways to do <em>almost</em> the same thing. For instance, another way to pick a particular column of a dataset is to use the ‘extract’ operator <code>$</code>. This is from base, as opposed to <code>select()</code> which is from the <code>tidyverse</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>australian_politicians<span class="sc">$</span>firstName <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "Richard"   "Percy"     "Macartney" "Charles"   "Joseph"    "Anthony"  </code></pre>
</div>
</div>
<p>The two appear similar—both pick the ‘firstName’ column—but they differ in the class of what they return. For the sake of completeness, if we combine <code>select()</code> with <code>pull()</code> then we get the same class of output as if we had used the extract operator.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(firstName) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "Richard"   "Percy"     "Macartney" "Charles"   "Joseph"    "Anthony"  </code></pre>
</div>
</div>
<p>We can also use <code>select()</code> to remove columns, by negating the column name.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>firstName) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 19
  uniqueID   surname allOtherNames commonName displayName earlierOrLaterN… title
  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;
1 Abbott1859 Abbott  Richard Hart… &lt;NA&gt;       Abbott, Ri… &lt;NA&gt;             &lt;NA&gt; 
2 Abbott1869 Abbott  Percy Phipps  &lt;NA&gt;       Abbott, Pe… &lt;NA&gt;             &lt;NA&gt; 
3 Abbott1877 Abbott  Macartney     Mac        Abbott, Mac &lt;NA&gt;             &lt;NA&gt; 
4 Abbott1886 Abbott  Charles Lydi… Aubrey     Abbott, Au… &lt;NA&gt;             &lt;NA&gt; 
5 Abbott1891 Abbott  Joseph Palmer &lt;NA&gt;       Abbott, Jo… &lt;NA&gt;             &lt;NA&gt; 
6 Abbott1957 Abbott  Anthony John  Tony       Abbott, To… &lt;NA&gt;             &lt;NA&gt; 
# … with 12 more variables: gender &lt;chr&gt;, birthDate &lt;date&gt;, birthYear &lt;dbl&gt;,
#   birthPlace &lt;chr&gt;, deathDate &lt;date&gt;, member &lt;dbl&gt;, senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;, wikidataID &lt;chr&gt;, wikipedia &lt;chr&gt;, adb &lt;chr&gt;,
#   comments &lt;chr&gt;</code></pre>
</div>
</div>
<p>Finally, we can <code>select()</code> based on conditions. For instance, we can <code>select()</code> all of the columns that start with, say, ‘birth’.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"birth"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
  birthDate  birthYear birthPlace  
  &lt;date&gt;         &lt;dbl&gt; &lt;chr&gt;       
1 NA              1859 Bendigo     
2 1869-05-14        NA Hobart      
3 1877-07-03        NA Murrurundi  
4 1886-01-04        NA St Leonards 
5 1891-10-18        NA North Sydney
6 1957-11-04        NA London      </code></pre>
</div>
</div>
<p>There are a variety of similar ‘selection helpers’ including <code>starts_with()</code>, <code>ends_with()</code>, and <code>contains()</code>. More information about these is available in the help page for <code>select()</code> which can be accessed by running <code>?select()</code>.</p>
<p>At this point, we will use <code>select()</code> to reduce the width of our dataset.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  australian_politicians <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>         surname,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>         firstName,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>         gender,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>         birthDate,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>         birthYear,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>         deathDate,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>         member,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>         senator,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>         wasPrimeMinister)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 10
  uniqueID   surname firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Abbott1859 Abbott  Richard   male   NA              1859 1940-02-28      0
2 Abbott1869 Abbott  Percy     male   1869-05-14        NA 1940-09-09      1
3 Abbott1877 Abbott  Macartney male   1877-07-03        NA 1960-12-30      0
4 Abbott1886 Abbott  Charles   male   1886-01-04        NA 1975-04-30      1
5 Abbott1891 Abbott  Joseph    male   1891-10-18        NA 1965-05-07      1
6 Abbott1957 Abbott  Anthony   male   1957-11-04        NA NA              1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="filter" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="filter"><span class="header-section-number">3.5.2</span> <code>filter()</code></h3>
<p>We use <code>filter()</code> to pick particular rows of a dataset. For instance, we might be only interested in politicians that became prime minister.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wasPrimeMinister <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 30 × 10
   uniqueID    surname firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Abbott1957  Abbott  Anthony   male   1957-11-04        NA NA              1
 2 Barton1849  Barton  Edmund    male   1849-01-18        NA 1920-01-07      1
 3 Bruce1883   Bruce   Stanley   male   1883-04-15        NA 1967-08-25      1
 4 Chifley1885 Chifley Joseph    male   1885-09-22        NA 1951-06-13      1
 5 Cook1860    Cook    Joseph    male   1860-12-07        NA 1947-07-30      1
 6 Curtin1885  Curtin  John      male   1885-01-08        NA 1945-07-05      1
 7 Deakin1856  Deakin  Alfred    male   1856-08-03        NA 1919-10-07      1
 8 Fadden1894  Fadden  Arthur    male   1894-04-13        NA 1973-04-21      1
 9 Fisher1862  Fisher  Andrew    male   1862-08-29        NA 1928-10-22      1
10 Forde1890   Forde   Francis   male   1890-07-18        NA 1983-01-28      1
# … with 20 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We could also give <code>filter()</code> two conditions. For instance, we could look at politicians that become prime minister and were named Joseph, using the ‘and’ operator <code>&amp;</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wasPrimeMinister <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> firstName <span class="sc">==</span> <span class="st">"Joseph"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 10
  uniqueID    surname firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Chifley1885 Chifley Joseph    male   1885-09-22        NA 1951-06-13      1
2 Cook1860    Cook    Joseph    male   1860-12-07        NA 1947-07-30      1
3 Lyons1879   Lyons   Joseph    male   1879-09-15        NA 1939-04-07      1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We get the same result if we use a comma instead of an ampersand.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wasPrimeMinister <span class="sc">==</span> <span class="dv">1</span>, firstName <span class="sc">==</span> <span class="st">"Joseph"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 10
  uniqueID    surname firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Chifley1885 Chifley Joseph    male   1885-09-22        NA 1951-06-13      1
2 Cook1860    Cook    Joseph    male   1860-12-07        NA 1947-07-30      1
3 Lyons1879   Lyons   Joseph    male   1879-09-15        NA 1939-04-07      1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Similarly, we could look at politicians who were named, say, Myles or Ruth using the ‘or’ operator <code>|</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(firstName <span class="sc">==</span> <span class="st">"Myles"</span> <span class="sc">|</span> firstName <span class="sc">==</span> <span class="st">"Ruth"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 10
  uniqueID     surname  firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Coleman1931  Coleman  Ruth      female 1931-09-27        NA 2008-03-27      0
2 Ferricks1875 Ferricks Myles     male   1875-11-12        NA 1932-08-20      0
3 Webber1965   Webber   Ruth      female 1965-03-24        NA NA              0
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We could also pipe the result. For instance we could pipe from <code>filter()</code> to <code>select()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(firstName <span class="sc">==</span> <span class="st">"Ruth"</span> <span class="sc">|</span> firstName <span class="sc">==</span> <span class="st">"Myles"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(firstName, surname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 2
  firstName surname 
  &lt;chr&gt;     &lt;chr&gt;   
1 Ruth      Coleman 
2 Myles     Ferricks
3 Ruth      Webber  </code></pre>
</div>
</div>
<p>If we happen to know the particular row number that is of interest then we could <code>filter()</code> to only that particular row. For instance, say the row 853 was of interest.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">853</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 × 10
  uniqueID     surname  firstName gender birthDate  birthYear deathDate member
  &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;
1 Jakobsen1947 Jakobsen Carolyn   female 1947-09-11        NA NA             1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There is also a dedicated function to do this, which is <code>slice()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">853</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 × 10
  uniqueID     surname  firstName gender birthDate  birthYear deathDate member
  &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;
1 Jakobsen1947 Jakobsen Carolyn   female 1947-09-11        NA NA             1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>While this may seem somewhat esoteric, it is especially useful if we would like to remove a particular row using negation, or duplicate specific rows. For instance, we could remove the first row.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,782 × 10
   uniqueID    surname firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Abbott1869  Abbott  Percy     male   1869-05-14        NA 1940-09-09      1
 2 Abbott1877  Abbott  Macartney male   1877-07-03        NA 1960-12-30      0
 3 Abbott1886  Abbott  Charles   male   1886-01-04        NA 1975-04-30      1
 4 Abbott1891  Abbott  Joseph    male   1891-10-18        NA 1965-05-07      1
 5 Abbott1957  Abbott  Anthony   male   1957-11-04        NA NA              1
 6 Abel1939    Abel    John      male   1939-06-25        NA NA              1
 7 Abetz1958   Abetz   Eric      male   1958-01-25        NA NA              0
 8 Adams1943   Adams   Judith    female 1943-04-11        NA 2012-03-31      0
 9 Adams1951   Adams   Dick      male   1951-04-29        NA NA              1
10 Adamson1857 Adamson John      male   1857-02-18        NA 1922-05-02      0
# … with 1,772 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We could also only, say, only keep the first three rows.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 10
  uniqueID   surname firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Abbott1859 Abbott  Richard   male   NA              1859 1940-02-28      0
2 Abbott1869 Abbott  Percy     male   1869-05-14        NA 1940-09-09      1
3 Abbott1877 Abbott  Macartney male   1877-07-03        NA 1960-12-30      0
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Finally, we could duplicate the first two rows.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,785 × 10
   uniqueID   surname firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Abbott1859 Abbott  Richard   male   NA              1859 1940-02-28      0
 2 Abbott1869 Abbott  Percy     male   1869-05-14        NA 1940-09-09      1
 3 Abbott1859 Abbott  Richard   male   NA              1859 1940-02-28      0
 4 Abbott1869 Abbott  Percy     male   1869-05-14        NA 1940-09-09      1
 5 Abbott1877 Abbott  Macartney male   1877-07-03        NA 1960-12-30      0
 6 Abbott1886 Abbott  Charles   male   1886-01-04        NA 1975-04-30      1
 7 Abbott1891 Abbott  Joseph    male   1891-10-18        NA 1965-05-07      1
 8 Abbott1957 Abbott  Anthony   male   1957-11-04        NA NA              1
 9 Abel1939   Abel    John      male   1939-06-25        NA NA              1
10 Abetz1958  Abetz   Eric      male   1958-01-25        NA NA              0
# … with 1,775 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="arrange" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="arrange"><span class="header-section-number">3.5.3</span> <code>arrange()</code></h3>
<p>We use <code>arrange()</code> to change the order of the dataset based on the values of particular columns. For instance, we could arrange the politicians by their birthday.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(birthDate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 10
   uniqueID     surname  firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Braddon1829  Braddon  Edward    male   1829-06-11        NA 1904-02-02      1
 2 Ferguson1830 Ferguson John      male   1830-03-15        NA 1906-03-30      0
 3 Zeal1830     Zeal     William   male   1830-12-05        NA 1912-03-11      0
 4 Fraser1832   Fraser   Simon     male   1832-08-21        NA 1919-07-30      0
 5 Groom1833    Groom    William   male   1833-03-09        NA 1901-08-08      1
 6 Sargood1834  Sargood  Frederick male   1834-05-30        NA 1903-01-02      0
 7 Fysh1835     Fysh     Philip    male   1835-03-01        NA 1919-12-20      1
 8 Playford1837 Playford Thomas    male   1837-11-26        NA 1915-04-19      0
 9 Solomon1839  Solomon  Elias     male   1839-09-02        NA 1909-05-23      1
10 McLean1840   McLean   Allan     male   1840-02-03        NA 1911-07-13      1
# … with 1,773 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We could modify <code>arrange()</code> with <code>desc()</code> to change from ascending to descending order.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(birthDate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 10
   uniqueID      surname firstName gender birthDate  birthYear deathDate member
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt;
 1 SteeleJohn19… Steele… Jordon    male   1994-10-14        NA NA             0
 2 Chandler1990  Chandl… Claire    female 1990-06-01        NA NA             0
 3 Roy1990       Roy     Wyatt     male   1990-05-22        NA NA             1
 4 Thompson1988  Thomps… Phillip   male   1988-05-07        NA NA             1
 5 Paterson1987  Paters… James     male   1987-11-21        NA NA             0
 6 Burns1987     Burns   Joshua    male   1987-02-06        NA NA             1
 7 Smith1986     Smith   Marielle  female 1986-12-30        NA NA             0
 8 KakoschkeMoo… Kakosc… Skye      female 1985-12-19        NA NA             0
 9 Simmonds1985  Simmon… Julian    male   1985-08-29        NA NA             1
10 Gorman1984    Gorman  Patrick   male   1984-12-12        NA NA             1
# … with 1,773 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>And we could arrange based on more than one column. For instance, if two politicians have the same first name, then we could also arrange based on their birthday.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(firstName, birthDate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 10
   uniqueID      surname firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Blain1894     Blain   Adair     male   1894-11-21        NA 1983-04-28      1
 2 Dein1889      Dein    Adam      male   1889-03-04        NA 1969-05-09      1
 3 Armstrong1909 Armstr… Adam      male   1909-07-01        NA 1982-02-22      1
 4 Bandt1972     Bandt   Adam      male   1972-03-11        NA NA              1
 5 Ridgeway1962  Ridgew… Aden      male   1962-09-18        NA NA              0
 6 Bennett1933   Bennett Adrian    male   1933-01-21        NA 2006-05-09      1
 7 Gibson1935    Gibson  Adrian    male   1935-11-03        NA 2015-04-30      1
 8 Wynne1850     Wynne   Agar      male   1850-01-15        NA 1934-05-12      1
 9 Robertson1882 Robert… Agnes     female 1882-07-31        NA 1968-01-29      0
10 Pittard1902   Pittard Alan      male   1902-11-15        NA 1992-12-25      1
# … with 1,773 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We could achieve the same result by piping between two instances of <code>arrange()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(birthDate) <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(firstName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 10
   uniqueID      surname firstName gender birthDate  birthYear deathDate  member
   &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Blain1894     Blain   Adair     male   1894-11-21        NA 1983-04-28      1
 2 Dein1889      Dein    Adam      male   1889-03-04        NA 1969-05-09      1
 3 Armstrong1909 Armstr… Adam      male   1909-07-01        NA 1982-02-22      1
 4 Bandt1972     Bandt   Adam      male   1972-03-11        NA NA              1
 5 Ridgeway1962  Ridgew… Aden      male   1962-09-18        NA NA              0
 6 Bennett1933   Bennett Adrian    male   1933-01-21        NA 2006-05-09      1
 7 Gibson1935    Gibson  Adrian    male   1935-11-03        NA 2015-04-30      1
 8 Wynne1850     Wynne   Agar      male   1850-01-15        NA 1934-05-12      1
 9 Robertson1882 Robert… Agnes     female 1882-07-31        NA 1968-01-29      0
10 Pittard1902   Pittard Alan      male   1902-11-15        NA 1992-12-25      1
# … with 1,773 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>When we use <code>arrange()</code> it is important to be clear about precedence. For instance, changing to birthday and then first name would give a different arrangement.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(birthYear, firstName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 10
   uniqueID    surname firstName gender birthDate birthYear deathDate  member
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;        &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
 1 Edwards1842 Edwards Richard   male   NA             1842 1915-10-29      1
 2 Sawers1844  Sawers  William   male   NA             1844 1916-05-19      1
 3 Barker1846  Barker  Stephen   male   NA             1846 1924-06-21      0
 4 Corser1852  Corser  Edward    male   NA             1852 1928-07-31      1
 5 Lee1856     Lee     Henry     male   NA             1856 1927-08-12      1
 6 Grant1857   Grant   John      male   NA             1857 1928-05-19      0
 7 Palmer1859  Palmer  Albert    male   NA             1859 1919-08-14      1
 8 Riley1859   Riley   Edward    male   NA             1859 1943-07-21      1
 9 Abbott1859  Abbott  Richard   male   NA             1859 1940-02-28      0
10 Kennedy1860 Kennedy Thomas    male   NA             1860 1929-02-16      1
# … with 1,773 more rows, and 2 more variables: senator &lt;dbl&gt;,
#   wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
<p>A nice way to arrange by a variety of columns is to use <code>across()</code>. It enables us to use the ‘selection helpers’ such as <code>starts_with()</code> that were mentioned in association with <code>select()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">c</span>(firstName, birthYear))) <span class="sc">|&gt;</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 10
  uniqueID      surname  firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;         &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Blain1894     Blain    Adair     male   1894-11-21        NA 1983-04-28      1
2 Armstrong1909 Armstro… Adam      male   1909-07-01        NA 1982-02-22      1
3 Bandt1972     Bandt    Adam      male   1972-03-11        NA NA              1
4 Dein1889      Dein     Adam      male   1889-03-04        NA 1969-05-09      1
5 Ridgeway1962  Ridgeway Aden      male   1962-09-18        NA NA              0
6 Bennett1933   Bennett  Adrian    male   1933-01-21        NA 2006-05-09      1
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">'birth'</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 10
  uniqueID     surname  firstName gender birthDate  birthYear deathDate  member
  &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;         &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;
1 Braddon1829  Braddon  Edward    male   1829-06-11        NA 1904-02-02      1
2 Ferguson1830 Ferguson John      male   1830-03-15        NA 1906-03-30      0
3 Zeal1830     Zeal     William   male   1830-12-05        NA 1912-03-11      0
4 Fraser1832   Fraser   Simon     male   1832-08-21        NA 1919-07-30      0
5 Groom1833    Groom    William   male   1833-03-09        NA 1901-08-08      1
6 Sargood1834  Sargood  Frederick male   1834-05-30        NA 1903-01-02      0
# … with 2 more variables: senator &lt;dbl&gt;, wasPrimeMinister &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="mutate" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="mutate"><span class="header-section-number">3.5.4</span> <code>mutate()</code></h3>
<p>We use <code>mutate()</code> when we want to make a new column. For instance, perhaps we want to make a new column that is 1 if a person was both a member and a senator and 0 otherwise. That is to say that our new column would denote politicians that served in both the upper and the lower house.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="ot">&lt;-</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">was_both =</span> <span class="fu">if_else</span>(member <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> senator <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(member, senator, was_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 3
   member senator was_both
    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1      0       1        0
 2      1       1        1
 3      0       1        0
 4      1       0        0
 5      1       0        0
 6      1       0        0
 7      1       0        0
 8      0       1        0
 9      0       1        0
10      1       0        0
# … with 1,773 more rows</code></pre>
</div>
</div>
<p>We could use <code>mutate()</code> with math, such as addition and subtraction. For instance, we could calculate the age that the politicians are (or would have been) in 2022.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="ot">&lt;-</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="dv">2022</span> <span class="sc">-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(birthDate))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 2
   uniqueID     age
   &lt;chr&gt;      &lt;dbl&gt;
 1 Abbott1859    NA
 2 Abbott1869   153
 3 Abbott1877   145
 4 Abbott1886   136
 5 Abbott1891   131
 6 Abbott1957    65
 7 Abel1939      83
 8 Abetz1958     64
 9 Adams1943     79
10 Adams1951     71
# … with 1,773 more rows</code></pre>
</div>
</div>
<p>There are a variety of functions that are especially useful when constructing new columns. These include <code>log()</code> which will compute the natural logarithm, <code>lead()</code> which will bring values up by one row, <code>lag()</code> which will push values down by one row, and <code>cumsum()</code> which creates a cumulative sum of the column.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, age) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_age =</span> <span class="fu">log</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
  uniqueID     age log_age
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 Abbott1859    NA   NA   
2 Abbott1869   153    5.03
3 Abbott1877   145    4.98
4 Abbott1886   136    4.91
5 Abbott1891   131    4.88
6 Abbott1957    65    4.17</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, age) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lead_age =</span> <span class="fu">lead</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
  uniqueID     age lead_age
  &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1 Abbott1859    NA      153
2 Abbott1869   153      145
3 Abbott1877   145      136
4 Abbott1886   136      131
5 Abbott1891   131       65
6 Abbott1957    65       83</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, age) <span class="sc">|&gt;</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lag_age =</span> <span class="fu">lag</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
  uniqueID     age lag_age
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 Abbott1859    NA      NA
2 Abbott1869   153      NA
3 Abbott1877   145     153
4 Abbott1886   136     145
5 Abbott1891   131     136
6 Abbott1957    65     131</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, age) <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumulative_age =</span> <span class="fu">cumsum</span>(age)) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
  uniqueID     age cumulative_age
  &lt;chr&gt;      &lt;dbl&gt;          &lt;dbl&gt;
1 Abbott1869   153            153
2 Abbott1877   145            298
3 Abbott1886   136            434
4 Abbott1891   131            565
5 Abbott1957    65            630
6 Abel1939      83            713</code></pre>
</div>
</div>
<p>As we have in earlier examples, we can also use <code>mutate()</code> in combination with <code>across()</code>. This includes the potential use of the selection helpers. For instance, we could count the number of characters in both the first and last names at the same time.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(firstName, surname), str_count)) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, firstName, surname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 3
   uniqueID   firstName surname
   &lt;chr&gt;          &lt;int&gt;   &lt;int&gt;
 1 Abbott1859         7       6
 2 Abbott1869         5       6
 3 Abbott1877         9       6
 4 Abbott1886         7       6
 5 Abbott1891         6       6
 6 Abbott1957         7       6
 7 Abel1939           4       4
 8 Abetz1958          4       5
 9 Adams1943          6       5
10 Adams1951          4       5
# … with 1,773 more rows</code></pre>
</div>
</div>
<p>Finally, we use <code>case_when()</code> when we need to make a new column on the basis of more than two conditional statements (in contrast to <code>if_else()</code> from our first <code>mutate()</code> example). For instance, we may have some years and want to group them into decades.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_of_birth =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(birthDate),</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">decade_of_birth =</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">case_when</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1929</span> <span class="sc">~</span> <span class="st">"pre-1930"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1939</span> <span class="sc">~</span> <span class="st">"1930s"</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1949</span> <span class="sc">~</span> <span class="st">"1940s"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1959</span> <span class="sc">~</span> <span class="st">"1950s"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1969</span> <span class="sc">~</span> <span class="st">"1960s"</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1979</span> <span class="sc">~</span> <span class="st">"1970s"</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1989</span> <span class="sc">~</span> <span class="st">"1980s"</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>             year_of_birth <span class="sc">&lt;=</span> <span class="dv">1999</span> <span class="sc">~</span> <span class="st">"1990s"</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Unknown or error"</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, year_of_birth, decade_of_birth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 3
   uniqueID   year_of_birth decade_of_birth 
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;           
 1 Abbott1859            NA Unknown or error
 2 Abbott1869          1869 pre-1930        
 3 Abbott1877          1877 pre-1930        
 4 Abbott1886          1886 pre-1930        
 5 Abbott1891          1891 pre-1930        
 6 Abbott1957          1957 1950s           
 7 Abel1939            1939 1930s           
 8 Abetz1958           1958 1950s           
 9 Adams1943           1943 1940s           
10 Adams1951           1951 1950s           
# … with 1,773 more rows</code></pre>
</div>
</div>
<p>We could accomplish this with a series of <code>if_else()</code> statements, but <code>case_when()</code> is more clear. The cases are evaluated in order and as soon as there is a match <code>case_when()</code> does not continue to the remainder of the cases. So it can be useful to have a catch-all at the end that will signal if there is a potential issue that we might like to know about.</p>
</section>
<section id="summarise" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="summarise"><span class="header-section-number">3.5.5</span> <code>summarise()</code></h3>
<p>We use <code>summarise()</code> when we would like to make new, condensed, summary variables. For instance, perhaps we would like to know the minimum, average, and maximum of some column.</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">youngest =</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">oldest =</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">average =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 × 3
  youngest oldest average
     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1       28    193    101.</code></pre>
</div>
</div>
<p>As an aside, <code>summarise()</code> and <code>summarize()</code> are equivalent and we can use either.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">youngest =</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">oldest =</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">average =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1 × 3
  youngest oldest average
     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1       28    193    101.</code></pre>
</div>
</div>
<p>By default, <code>summarise()</code> will provide one row of output for a whole dataset. For instance, in the earlier example we found the youngest, oldest, and average across all politicians. However, we can create more groups in our dataset using <code>group_by()</code>. And we can then apply another function within the context of those groups. We could use many functions on the basis of groups, but the <code>summarise()</code> function is particularly powerful in conjunction with <code>group_by()</code>. For instance, we could group by gender, and then get age-based summary statistics.</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">youngest =</span> <span class="fu">min</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">oldest =</span> <span class="fu">max</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">average =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 4
  gender youngest oldest average
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 female       32    140    66.0
2 male         28    193   106. </code></pre>
</div>
</div>
<p>Similarly, we could look at youngest, oldest, and mean age at death by gender.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days_lived =</span> deathDate <span class="sc">-</span> birthDate) <span class="sc">|&gt;</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(days_lived)) <span class="sc">|&gt;</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_days =</span> <span class="fu">min</span>(days_lived),</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_days =</span> <span class="fu">mean</span>(days_lived) <span class="sc">|&gt;</span> <span class="fu">round</span>(),</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_days =</span> <span class="fu">max</span>(days_lived)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 4
  gender min_days   mean_days  max_days  
  &lt;chr&gt;  &lt;drtn&gt;     &lt;drtn&gt;     &lt;drtn&gt;    
1 female 14856 days 28857 days 35560 days
2 male   12380 days 27376 days 36416 days</code></pre>
</div>
</div>
<p>And so we learn that female members of parliament on average lived slightly longer than male members of parliament.</p>
<p>We can use <code>group_by()</code> on the basis of more than one group. For instance, we could look at the average number of days lived by gender and by house.</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days_lived =</span> deathDate <span class="sc">-</span> birthDate) <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(days_lived)) <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, member) <span class="sc">|&gt;</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_days =</span> <span class="fu">min</span>(days_lived),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_days =</span> <span class="fu">mean</span>(days_lived) <span class="sc">|&gt;</span> <span class="fu">round</span>(),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_days =</span> <span class="fu">max</span>(days_lived)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   gender [2]
  gender member min_days   mean_days  max_days  
  &lt;chr&gt;   &lt;dbl&gt; &lt;drtn&gt;     &lt;drtn&gt;     &lt;drtn&gt;    
1 female      0 21746 days 29517 days 35560 days
2 female      1 14856 days 27538 days 33442 days
3 male        0 13619 days 27133 days 36416 days
4 male        1 12380 days 27496 days 36328 days</code></pre>
</div>
</div>
<p>We can use <code>count()</code> to create counts by groups. For instance, the number of politicians by gender.</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   gender [2]
  gender     n
  &lt;chr&gt;  &lt;int&gt;
1 female   240
2 male    1543</code></pre>
</div>
</div>
<p>In addition to the <code>count()</code>, we could calculate a proportion.</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n<span class="sc">/</span>(<span class="fu">sum</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 3
  gender     n proportion
  &lt;chr&gt;  &lt;int&gt;      &lt;dbl&gt;
1 female   240      0.135
2 male    1543      0.865</code></pre>
</div>
</div>
<p>Using <code>count()</code> is essentially the same as using <code>group_by()</code> and then <code>summarise()</code> with <code>n()</code>, and we get the same result in that way.</p>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 2
  gender     n
  &lt;chr&gt;  &lt;int&gt;
1 female   240
2 male    1543</code></pre>
</div>
</div>
<p>And there is a comparably helpful function that acts similarly to<code>mutate()</code>, which is <code>add_count()</code>. The difference is that the number will be added in a new column.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>australian_politicians <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(uniqueID, gender, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 1,783 × 3
# Groups:   gender [2]
   uniqueID   gender     n
   &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;
 1 Abbott1859 male    1543
 2 Abbott1869 male    1543
 3 Abbott1877 male    1543
 4 Abbott1886 male    1543
 5 Abbott1891 male    1543
 6 Abbott1957 male    1543
 7 Abel1939   male    1543
 8 Abetz1958  male    1543
 9 Adams1943  female   240
10 Adams1951  male    1543
# … with 1,773 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="base" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="base"><span class="header-section-number">3.6</span> Base</h2>
<p>While the <code>tidyverse</code> was established relatively recently to help with data science, R existed long before this. There is a host of functionality that is built into R especially around the core needs of programming and statisticians.</p>
<p>In particular, we will cover:</p>
<ol type="1">
<li><code>class()</code></li>
<li>Data simulation</li>
<li><code>function()</code>, <code>for()</code>, and <code>apply()</code></li>
</ol>
<p>There is no need to install or load any additional packages, as this functionality comes with R.</p>
<section id="class" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="class"><span class="header-section-number">3.6.1</span> <code>class()</code></h3>
<p>In everyday usage ‘a, b, c, …’ are letters and ‘1, 2, 3,…’ are numbers. And we use letters and numbers differently; for instance, we do not add or subtract letters. Similarly, R needs to have some way of distinguishing different classes of content and to define the properties that each class has, ‘how it behaves, and how it relates to other types of objects’ <span class="citation" data-cites="advancedr">(<a href="references.html#ref-advancedr" role="doc-biblioref">Wickham 2019a</a>)</span>.</p>
<p>Classes have a hierarchy. For instance, we are ‘human’, which is itself ‘animal’. All ‘humans’ are ‘animals’, but not all ‘animals’ are ‘humans’. Similarly, all integers are numbers, but not all numbers are integers. We can find out the class of an object in R with <code>class()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>a_number <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>a_letter <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_letter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>The classes that we cover here are ‘numeric’, ‘character’, ‘factor’, ‘date’, and ‘data.frame’.</p>
<p>The first thing to know is that, in the same way that a frog can become a prince, we can sometimes change the class of an object in R. For instance, we could start with a ‘numeric’, change it to a ‘character’ with <code>as.character()</code>, and then a ‘factor’ with <code>as.factor()</code>. But if we tried to make it into a ‘date’ with <code>as.Date()</code> we would get an error because no all numbers have the properties that are needed to be a date.</p>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>a_number <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>a_number</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>a_number <span class="ot">&lt;-</span> <span class="fu">as.character</span>(a_number)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>a_number</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "8"</code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>a_number <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(a_number)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>a_number</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 8
Levels: 8</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<p>Compared with ‘numeric’ and ‘character’ classes, the ‘factor’ class might be less familiar. A ‘factor’ is used for categorical data that can only take certain values <span class="citation" data-cites="advancedr">(<a href="references.html#ref-advancedr" role="doc-biblioref">Wickham 2019a</a>)</span>. For instance, typical usage of a ‘factor’ variable would be a binary, such as ‘day’ or ‘night’. It is also often used for age-groups, such as ‘18-29’, ‘30-44’, ‘45-60’, ‘60+’ (as opposed to age, which would often be a ‘numeric’); and sometimes for level of education: ‘less than high school’, ‘high school’, ‘college’, ‘undergraduate degree’, ‘postgraduate degree’. We can find the allowed levels for a ‘factor’ using <code>levels()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">'18-29'</span>, <span class="st">'30-44'</span>, <span class="st">'45-60'</span>, <span class="st">'60+'</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>age_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] 18-29 30-44 45-60 60+  
Levels: 18-29 30-44 45-60 60+</code></pre>
</div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(age_groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(age_groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "18-29" "30-44" "45-60" "60+"  </code></pre>
</div>
</div>
<p>Dates are an especially tricky class and quickly become complicated. Nonetheless, at a foundational level, we can use <code>as.Date()</code> to convert a character that looks like a ‘date’ into an actual ‘date’. This enables us to, say, perform addition and subtraction, when we would not be able to do that with a ‘character’.</p>
<div class="cell">
<div class="sourceCode" id="cb117"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>looks_like_a_date_but_is_not <span class="ot">&lt;-</span> <span class="st">"2022-01-01"</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>looks_like_a_date_but_is_not</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "2022-01-01"</code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(looks_like_a_date_but_is_not)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>is_a_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(looks_like_a_date_but_is_not)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>is_a_date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "2022-01-01"</code></pre>
</div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(is_a_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>is_a_date <span class="sc">+</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "2022-01-04"</code></pre>
</div>
</div>
<p>The final class that we discuss here is ‘data.frame’. This looks like a spreadsheet and is commonly used to store the data that we will analyze. Formally, ‘a data frame is a list of equal-length vectors’ <span class="citation" data-cites="advancedr">(<a href="references.html#ref-advancedr" role="doc-biblioref">Wickham 2019a</a>)</span>. It will have column and row names which we can see using <code>colnames()</code> and <code>rownames()</code>, although often the names of the rows are just numbers.</p>
<p>To illustrate this, we use the ‘ResumeNames’ dataset from <code>AER</code> <span class="citation" data-cites="citeaer">(<a href="references.html#ref-citeaer" role="doc-biblioref">Kleiber and Zeileis 2008</a>)</span>. This package can be installed in the same way as any other package from CRAN. This dataset comprises cross-sectional data about resume content, especially the name used on the resume, and associated information about whether the candidate received a call-back for 4,870 fictitious resumes. The dataset was created by <span class="citation" data-cites="bertrand2004emily">Bertrand and Mullainathan (<a href="references.html#ref-bertrand2004emily" role="doc-biblioref">2004</a>)</span> who sent fictitious resumes in response to job advertisements in Boston and Chicago that differed in whether the resume was assigned a ‘very African American sounding name or a very White sounding name’. They found considerable discrimination whereby ‘White names receive 50 percent more callbacks for interviews’. <span class="citation" data-cites="hangartner2021monitoring">Hangartner, Kopp, and Siegenthaler (<a href="references.html#ref-hangartner2021monitoring" role="doc-biblioref">2021</a>)</span> generalize this using an online Swiss platform and find that immigrants and minority ethnic groups are contacted less by recruiters, as are women when the profession is men-dominated, and vice versa.</p>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"AER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ResumeNames"</span>, <span class="at">package =</span> <span class="st">"AER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>ResumeNames <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>     name gender ethnicity quality call    city jobs experience honors
1 Allison female      cauc     low   no chicago    2          6     no
2 Kristen female      cauc    high   no chicago    3          6     no
3 Lakisha female      afam     low   no chicago    1          6     no
4 Latonya female      afam    high   no chicago    4          6     no
5  Carrie female      cauc    high   no chicago    3         22     no
6     Jay   male      cauc     low   no chicago    2          6    yes
  volunteer military holes school email computer special college minimum equal
1        no       no   yes     no    no      yes      no     yes       5   yes
2       yes      yes    no    yes   yes      yes      no      no       5   yes
3        no       no    no    yes    no      yes      no     yes       5   yes
4       yes       no   yes     no   yes      yes     yes      no       5   yes
5        no       no    no    yes   yes      yes      no      no    some   yes
6        no       no    no     no    no       no     yes     yes    none   yes
      wanted requirements reqexp reqcomm reqeduc reqcomp reqorg
1 supervisor          yes    yes      no      no     yes     no
2 supervisor          yes    yes      no      no     yes     no
3 supervisor          yes    yes      no      no     yes     no
4 supervisor          yes    yes      no      no     yes     no
5  secretary          yes    yes      no      no     yes    yes
6      other           no     no      no      no      no     no
                          industry
1                    manufacturing
2                    manufacturing
3                    manufacturing
4                    manufacturing
5 health/education/social services
6                            trade</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResumeNames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code> [1] "name"         "gender"       "ethnicity"    "quality"      "call"        
 [6] "city"         "jobs"         "experience"   "honors"       "volunteer"   
[11] "military"     "holes"        "school"       "email"        "computer"    
[16] "special"      "college"      "minimum"      "equal"        "wanted"      
[21] "requirements" "reqexp"       "reqcomm"      "reqeduc"      "reqcomp"     
[26] "reqorg"       "industry"    </code></pre>
</div>
</div>
<p>We can examine the class of the vectors, i.e.&nbsp;the columns, that make-up a data frame by specifying the column name.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>jobs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<p>Sometimes it is helpful to be able to change the classes of many columns at once. We can do this by using <code>mutate()</code> and <code>across()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>ethnicity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>ResumeNames <span class="ot">&lt;-</span> ResumeNames <span class="sc">|&gt;</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(name, gender, ethnicity), as.character)) <span class="sc">|&gt;</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ResumeNames<span class="sc">$</span>ethnicity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>There are many ways for code to not run but having an issue with the class is always among the first things to check. Common issues are variables that we think should be ‘character’ or ‘numeric’ actually being ‘factor’. And variables that we think should be ‘numeric’ actually being ‘character’.</p>
</section>
<section id="simulating-data" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="simulating-data"><span class="header-section-number">3.6.2</span> Simulating data</h3>
<p>Simulating data is a key skill for telling believable stories with data. In order to simulate data, we need to be able to randomly draw from statistical distributions and other collections. R has a variety of functions to make this easier, including: the normal distribution, <code>rnorm()</code>; the uniform distribution, <code>runif()</code>; the Poisson distribution, <code>rpois()</code>; the binomial distribution, <code>rbinom()</code>; and many others. To randomly sample from a collection of items, we can use <code>sample()</code>.</p>
<p>When dealing with randomness, the need for reproducibility makes it important, paradoxically, that the randomness is repeatable. That is to say, another person needs to be able to draw the random numbers that we draw. We do this by setting a seed for our random draws using <code>set.seed()</code>.</p>
<p>We could get observations from the standard normal distribution and put the those into a data frame.</p>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>number_of_observations <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span> </span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">person =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>number_of_observations),</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">std_normal_observations =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> number_of_observations,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">mean =</span> <span class="dv">0</span>,</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>simulated_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  person std_normal_observations
1      1             -0.35980342
2      2             -0.04064753
3      3             -1.78216227
4      4             -1.12242282
5      5             -1.00278400</code></pre>
</div>
</div>
<p>We could then add draws from the uniform, Poisson, and binomial distributions, using <code>cbind()</code> to bring the columns of the original dataset and the new one together.</p>
<div class="cell">
<div class="sourceCode" id="cb153"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">uniform_observations =</span> </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="at">n =</span> number_of_observations, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">poisson_observations =</span> </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rpois</span>(<span class="at">n =</span> number_of_observations, <span class="at">lambda =</span> <span class="dv">100</span>),</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">binomial_observations =</span> </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rbinom</span>(<span class="at">n =</span> number_of_observations, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(simulated_data)</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>simulated_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  uniform_observations poisson_observations binomial_observations person
1            9.6219155                   81                     2      1
2            7.2269016                   91                     1      2
3            0.8252921                   84                     1      3
4            1.0379810                  100                     1      4
5            3.0942004                   97                     1      5
  std_normal_observations
1             -0.35980342
2             -0.04064753
3             -1.78216227
4             -1.12242282
5             -1.00278400</code></pre>
</div>
</div>
<p>Finally, we will add a favorite color to each observation with <code>sample()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb155"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>simulated_data <span class="ot">&lt;-</span> </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">favorite_color =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">" white "</span>), </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> number_of_observations,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(simulated_data)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>simulated_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  favorite_color uniform_observations poisson_observations
1           blue            9.6219155                   81
2           blue            7.2269016                   91
3           blue            0.8252921                   84
4         white             1.0379810                  100
5           blue            3.0942004                   97
  binomial_observations person std_normal_observations
1                     2      1             -0.35980342
2                     1      2             -0.04064753
3                     1      3             -1.78216227
4                     1      4             -1.12242282
5                     1      5             -1.00278400</code></pre>
</div>
</div>
<p>We set the option ‘replace’ to ‘TRUE’ because we are only choosing between two items, but each time we choose we want the possibility that either are chosen. Depending on the simulation we may need to think about whether ‘replace’ should be ‘TRUE’ or ‘FALSE’. Another useful optional argument in <code>sample()</code> is to adjust the probability with which each item is drawn. The default is that all options are equally likely, but we could specify particular probabilities if we wanted to with ‘prob’. As always with functions, we can find more in the help file, for instance <code>?sample</code>.</p>
</section>
<section id="function-for-and-apply" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="function-for-and-apply"><span class="header-section-number">3.6.3</span> <code>function()</code>, <code>for()</code>, and <code>apply()</code></h3>
<p>R ‘is a functional programming language’ <span class="citation" data-cites="advancedr">(<a href="references.html#ref-advancedr" role="doc-biblioref">Wickham 2019a</a>)</span>. This means that we foundationally write, use, and compose functions, which are collections of code that accomplish something specific.</p>
<p>There are a lot of functions in R that other people have written, and we can use. Almost any common statistical or data science task that we might need to accomplish likely already has a function that has been written by someone else and made available to us, either as part of the base R installation or a package. But we will need to write our own functions from time to time, especially for more-specific tasks. We define a function using <code>function()</code>, and then assign a name. We will likely need to include some inputs and outputs for the function. Inputs are specified between round brackets. The specific task that the function is to accomplish goes between braces.</p>
<div class="cell">
<div class="sourceCode" id="cb157"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>print_names <span class="ot">&lt;-</span> <span class="cf">function</span>(some_names) {</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(some_names)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print_names</span>(<span class="fu">c</span>(<span class="st">"rohan"</span>, <span class="st">"monica"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "rohan"  "monica"</code></pre>
</div>
</div>
<p>We can specify defaults for the inputs in case the person using the function does not supply them.</p>
<div class="cell">
<div class="sourceCode" id="cb159"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>print_names <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">some_names =</span> <span class="fu">c</span>(<span class="st">"edward"</span>, <span class="st">"hugo"</span>)) {</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(some_names)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "edward" "hugo"  </code></pre>
</div>
</div>
<p>One common scenario is that we want to apply a function multiple times. Like many programming languages, we can use a <code>for()</code> loop for this. The look of a <code>for()</code> loop in R is similar to <code>function()</code>, in that we define what we are iterating over in the round brackets, and the function to apply in braces.</p>
<!-- ```{r} -->
<!-- for (i in 1:3) { -->
<!--   print(i) -->
<!-- } -->
<!-- ``` -->
<!-- ```{r} -->
<!-- x <- cbind(x1 = 66, x2 = c(4:1, 2:5)) -->
<!-- dimnames(x)[[1]] <- letters[1:8] -->
<!-- class(x) -->
<!-- apply(x, 2, mean, trim = .2) -->
<!-- ``` -->
<p>Because R is a programming language that is focused on statistics, we are often interested in arrays or matrices. We use <code>apply()</code> to apply a function to rows (‘MARGIN = 1’) or columns (‘MARGIN = 2’).</p>
<div class="cell">
<div class="sourceCode" id="cb161"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>simulated_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>  favorite_color uniform_observations poisson_observations
1           blue            9.6219155                   81
2           blue            7.2269016                   91
3           blue            0.8252921                   84
4         white             1.0379810                  100
5           blue            3.0942004                   97
  binomial_observations person std_normal_observations
1                     2      1             -0.35980342
2                     1      2             -0.04064753
3                     1      3             -1.78216227
4                     1      4             -1.12242282
5                     1      5             -1.00278400</code></pre>
</div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> simulated_data, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>$favorite_color
[1] "blue"    " white "

$uniform_observations
[1] "9.6219155" "7.2269016" "0.8252921" "1.0379810" "3.0942004"

$poisson_observations
[1] " 81" " 91" " 84" "100" " 97"

$binomial_observations
[1] "2" "1"

$person
[1] "1" "2" "3" "4" "5"

$std_normal_observations
[1] "-0.35980342" "-0.04064753" "-1.78216227" "-1.12242282" "-1.00278400"</code></pre>
</div>
</div>
</section>
</section>
<section id="making-graphs-with-ggplot2" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="making-graphs-with-ggplot2"><span class="header-section-number">3.7</span> Making graphs with <code>ggplot2</code></h2>
<p>If the key package in the <code>tidyverse</code> in terms of manipulating data is <code>dplyr</code> <span class="citation" data-cites="citedplyr">(<a href="references.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>, then the key package in the <code>tidyverse</code> in terms of creating graphs is <code>ggplot2</code> <span class="citation" data-cites="citeggplot">(<a href="references.html#ref-citeggplot" role="doc-biblioref">Wickham 2016</a>)</span>.<code>ggplot2</code> works by defining layers which build to form a graph, based around the ‘grammar of graphics’ (hence, the ‘gg’). Instead of the pipe operator (<code>|&gt;</code>) ggplot uses the add operator <code>+</code>. As part of the <code>tidyverse</code> collection of packages, <code>ggplot2</code> does not need to be explicitly installed or loaded if the <code>tidyverse</code> has been loaded.</p>
<p>There are three key aspects that need to be specified to build a graph with <code>ggplot2</code>:</p>
<ol type="1">
<li>Data;</li>
<li>Aesthetics / mapping; and</li>
<li>Type.</li>
</ol>
<p>To get started we will obtain some GDP data for countries in the Organisation for Economic Co-operation and Development (OECD) <span class="citation" data-cites="citeoecdgdp">(<a href="references.html#ref-citeoecdgdp" role="doc-biblioref">OECD 2022</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb165"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>oecd_gdp <span class="ot">&lt;-</span> </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="st">"https://stats.oecd.org/sdmx-json/data/DP_LIVE/.QGDP.../OECD?contentType=csv&amp;detail=code&amp;separator=comma&amp;csv-lang=en"</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(oecd_gdp, <span class="st">'inputs/data/oecd_gdp.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 8
  LOCATION INDICATOR SUBJECT MEASURE  FREQUENCY TIME  Value `Flag Codes`
  &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       
1 OECD     QGDP      TOT     PC_CHGPP A         1962   5.70 &lt;NA&gt;        
2 OECD     QGDP      TOT     PC_CHGPP A         1963   5.20 &lt;NA&gt;        
3 OECD     QGDP      TOT     PC_CHGPP A         1964   6.38 &lt;NA&gt;        
4 OECD     QGDP      TOT     PC_CHGPP A         1965   5.35 &lt;NA&gt;        
5 OECD     QGDP      TOT     PC_CHGPP A         1966   5.75 &lt;NA&gt;        
6 OECD     QGDP      TOT     PC_CHGPP A         1967   3.96 &lt;NA&gt;        </code></pre>
</div>
</div>
<p>We are interested, firstly, in making a bar chart of GDP change in the third quarter of 2021 for ten countries: Australia, Canada, Chile, Indonesia, Germany, Great Britain, New Zealand, South Africa, Spain, and the US.</p>
<div class="cell">
<div class="sourceCode" id="cb167"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="ot">&lt;-</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  oecd_gdp <span class="sc">|&gt;</span> </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME <span class="sc">==</span> <span class="st">"2021-Q3"</span>,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>         SUBJECT <span class="sc">==</span> <span class="st">"TOT"</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>         LOCATION <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"AUS"</span>, <span class="st">"CAN"</span>, <span class="st">"CHL"</span>, <span class="st">"DEU"</span>, <span class="st">"GBR"</span>,</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"IDN"</span>, <span class="st">"ESP"</span>, <span class="st">"NZL"</span>, <span class="st">"USA"</span>, <span class="st">"ZAF"</span>),</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>         MEASURE <span class="sc">==</span> <span class="st">"PC_CHGPY"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">european =</span> <span class="fu">if_else</span>(LOCATION <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEU"</span>, <span class="st">"GBR"</span>, <span class="st">"ESP"</span>),</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"European"</span>,</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Not european"</span>),</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">hemisphere =</span> <span class="fu">if_else</span>(LOCATION <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CAN"</span>, <span class="st">"DEU"</span>, <span class="st">"GBR"</span>, <span class="st">"ESP"</span>, <span class="st">"USA"</span>),</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Northern Hemisphere"</span>,</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Southern Hemisphere"</span>),</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We start with <code>ggplot()</code> and specify a mapping/aesthetic, which in this case means specifying the x-axis and the y-axis. The first argument in <code>ggplot()</code> is the data we want to visualize, so we can use the pipe operator at this stage as usual.</p>
<div class="cell">
<div class="sourceCode" id="cb168"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span> </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we need to specify the type of graph that we are interested in. In this case we want a bar chart and we do this by adding <code>geom_bar()</code> using <code>+</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb169"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span> </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can color the bars by whether the country is European by adding another aesthetic, ‘fill’.</p>
<div class="cell">
<div class="sourceCode" id="cb170"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span> </span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value, <span class="at">fill =</span> european)) <span class="sc">+</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, we could make it look nicer by: adding labels, <code>labs()</code>; changing the color, <code>scale_fill_brewer()</code>; and the background, <code>theme_classic()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb171"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value, <span class="at">fill =</span> european)) <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quarterly change in GDP for ten OECD countries in 2021Q3"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Countries"</span>, </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change (%)"</span>,</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Is European?"</span>) <span class="sc">+</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Facets enable us to that we create subplots that focus on specific aspects of our data. They are invaluable because they allow us to add another variable to a graph without having to make a 3D graph. We use <code>facet_wrap()</code> to add facets and specify the variable that we would like to facet by. In this case, we facet by hemisphere.</p>
<div class="cell">
<div class="sourceCode" id="cb172"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>oecd_gdp_most_recent <span class="sc">|&gt;</span> </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> LOCATION, <span class="at">y =</span> Value, <span class="at">fill =</span> european)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quarterly change in GDP for ten OECD countries in 2021Q3"</span>, </span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Countries"</span>, </span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change (%)"</span>,</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Is European?"</span>) <span class="sc">+</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>hemisphere, </span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exploring-the-tidyverse" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="exploring-the-tidyverse"><span class="header-section-number">3.8</span> Exploring the <code>tidyverse</code></h2>
<p>We have focused on two aspects of the <code>tidyverse</code>: <code>dplyr</code>, and <code>ggplot2</code>. However, the <code>tidyverse</code> comprises a variety of different packages and functions. We will now go through four common aspects:</p>
<ul>
<li>Importing data and <code>tibble()</code>;</li>
<li>Joining and pivoting datasets;</li>
<li>String manipulation and <code>stringr</code>;</li>
<li>Factor variables and <code>forcats</code>.</li>
</ul>
<p>However, the first task is to deal with the nomenclature, and in particular to be specific about what is ‘tidy’ about the ‘tidyverse’. The name refers to tidy data, and the benefit of that is that while there are a variety of ways for data to be messy, tidy data satisfy three rules. This means the structure of the datasets is consistent regardless of the specifics, and makes it easier to apply functions that expect certain types of input. Tidy data refers to a dataset where <span class="citation" data-cites="r4ds wickham2014tidy">(<a href="references.html#ref-r4ds" role="doc-biblioref">Wickham and Grolemund 2017</a>; <a href="references.html#ref-wickham2014tidy" role="doc-biblioref">Wickham 2014, 4</a>)</span>:</p>
<ul>
<li>Every variable is in a column of its own.</li>
<li>Every observation is in its own row.</li>
<li>Every value is in its own cell.</li>
</ul>
<p><a href="#tbl-nottidydata">Table&nbsp;<span>3.1</span></a> is not tidy because age and hair share a column. <a href="#tbl-tidydata">Table&nbsp;<span>3.2</span></a> is its tidy counterpart.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-nottidydata" class="anchored">
<table class="table table-sm table-striped">
<caption>Table 3.1: Example of data that are not tidy</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Person</th>
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rohan</td>
<td style="text-align: left;">Age</td>
<td style="text-align: left;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rohan</td>
<td style="text-align: left;">Hair</td>
<td style="text-align: left;">Black</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Monica</td>
<td style="text-align: left;">Age</td>
<td style="text-align: left;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Monica</td>
<td style="text-align: left;">Hair</td>
<td style="text-align: left;">Blonde</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Edward</td>
<td style="text-align: left;">Age</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Edward</td>
<td style="text-align: left;">Hair</td>
<td style="text-align: left;">Brown</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hugo</td>
<td style="text-align: left;">Age</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hugo</td>
<td style="text-align: left;">Hair</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tidydata" class="anchored">
<table class="table table-sm table-striped">
<caption>Table 3.2: Example of tidy data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Person</th>
<th style="text-align: right;">Age</th>
<th style="text-align: left;">Hair</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rohan</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">Black</td>
</tr>
<tr class="even">
<td style="text-align: left;">Monica</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">Blonde</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Edward</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Brown</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hugo</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="importing-data-and-tibble" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="importing-data-and-tibble"><span class="header-section-number">3.8.1</span> Importing data and <code>tibble()</code></h3>
<p>There are a variety of ways to get data into R so that we can use it. For CSV files, there is <code>read_csv()</code> from <code>readr</code> <span class="citation" data-cites="citereadr">(<a href="references.html#ref-citereadr" role="doc-biblioref">Wickham, Hester, and Bryan 2021</a>)</span>, and for dta files, there is <code>read_dta()</code> from <code>haven</code> <span class="citation" data-cites="citehaven">(<a href="references.html#ref-citehaven" role="doc-biblioref">Wickham and Miller 2020</a>)</span>.</p>
<p>CSVs are a common format and have many advantages including the fact that they typically do not modify the data. Each column is separated by a comma, and each row is a record. We can provide <code>read_csv()</code> with a URL or a local file to read. There are a variety of different options that can be passed to <code>read_csv()</code> including the ability to specify whether the dataset has column names, the types of the columns, and how many lines to skip. If we do not specify the types of the columns then <code>read_csv()</code> will make a guess by looking at the dataset.</p>
<p>We use <code>read_dta()</code> to read .dta files, which are commonly produced by the statistical program Stata. This means that they are common in fields such as sociology, political science, and economics. This format separates the data from its labels and so we typically reunite these using <code>to_factor()</code> from <code>labelled</code> <span class="citation" data-cites="citelabelled">(<a href="references.html#ref-citelabelled" role="doc-biblioref">Larmarange 2021</a>)</span>. <code>haven</code> is part of the <code>tidyverse</code>, but is not automatically loaded by default, in contrast to a package such as <code>ggplot2</code>, and so we would need to run <code>library(haven)</code>.</p>
<p>Typically a dataset enters R as a ‘data.frame’. While this can be useful, another helpful class for a dataset is ‘tibble’. These can be created using <code>tibble()</code> from the <code>tibble</code> package which is part of the <code>tidyverse</code>. A tibble is a data frame, with some particular changes that make it easier to work with, including not converting strings to factors by default, showing the class of columns, and printing nicely.</p>
<p>We can make a tibble manually, if need be, for instance, when we simulate data. But we typically import data directly as a tibble, for instance, when we use <code>read_csv()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb173"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>people_as_dataframe <span class="ot">&lt;-</span> </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"rohan"</span>, <span class="st">"monica"</span>),</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">website =</span> <span class="fu">c</span>(<span class="st">"rohanalexander.com"</span>, <span class="st">"monicaalexander.com"</span>),</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">fav_color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">" white "</span>)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(people_as_dataframe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>people_as_dataframe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>   names             website fav_color
1  rohan  rohanalexander.com      blue
2 monica monicaalexander.com    white </code></pre>
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>people_as_tibble <span class="ot">&lt;-</span> </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"rohan"</span>, <span class="st">"monica"</span>),</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">website =</span> <span class="fu">c</span>(<span class="st">"rohanalexander.com"</span>, <span class="st">"monicaalexander.com"</span>),</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">fav_color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">" white "</span>)</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>people_as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 2 × 3
  names  website             fav_color
  &lt;chr&gt;  &lt;chr&gt;               &lt;chr&gt;    
1 rohan  rohanalexander.com  "blue"   
2 monica monicaalexander.com " white "</code></pre>
</div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(people_as_tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
</section>
<section id="dataset-manipulation-with-joins-and-pivots" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="dataset-manipulation-with-joins-and-pivots"><span class="header-section-number">3.8.2</span> Dataset manipulation with joins and pivots</h3>
<p>There are two dataset manipulations that are often needed: joins and pivots.</p>
<p>We often have a situation where we have two, or more, datasets and we are interested in combining them. We can join datasets together in a variety of ways. A common way is to use <code>left_join()</code> from <code>dplyr</code> <span class="citation" data-cites="citedplyr">(<a href="references.html#ref-citedplyr" role="doc-biblioref">Wickham et al. 2020</a>)</span>. This is most useful where there is one main dataset that we are using and there is another dataset with some useful variables that we want to add to that. The critical aspect is that we have a column or columns that we can use to link the two datasets. Here we will create two tibbles and then join them on the basis of names.</p>
<div class="cell">
<div class="sourceCode" id="cb181"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>main_dataset <span class="ot">&lt;-</span> </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">'rohan'</span>, <span class="st">'monica'</span>, <span class="st">'edward'</span>, <span class="st">'hugo'</span>),</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">c</span>(<span class="st">'adult'</span>, <span class="st">'adult'</span>, <span class="st">'child'</span>, <span class="st">'infant'</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>main_dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 2
  names  status
  &lt;chr&gt;  &lt;chr&gt; 
1 rohan  adult 
2 monica adult 
3 edward child 
4 hugo   infant</code></pre>
</div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>supplementary_dataset <span class="ot">&lt;-</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">'rohan'</span>, <span class="st">'monica'</span>, <span class="st">'edward'</span>, <span class="st">'hugo'</span>),</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">favorite_food =</span> <span class="fu">c</span>(<span class="st">'pasta'</span>, <span class="st">'salmon'</span>, <span class="st">'pizza'</span>, <span class="st">'milk'</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>supplementary_dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 2
  names  favorite_food
  &lt;chr&gt;  &lt;chr&gt;        
1 rohan  pasta        
2 monica salmon       
3 edward pizza        
4 hugo   milk         </code></pre>
</div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>main_dataset <span class="ot">&lt;-</span> </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  main_dataset <span class="sc">|&gt;</span> </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(supplementary_dataset, <span class="at">by =</span> <span class="st">"names"</span>)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>main_dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 3
  names  status favorite_food
  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;        
1 rohan  adult  pasta        
2 monica adult  salmon       
3 edward child  pizza        
4 hugo   infant milk         </code></pre>
</div>
</div>
<p>There are a variety of other options to join datasets, including <code>inner_join()</code>, <code>right_join()</code>, and <code>full_join()</code>.</p>
<p>Another common dataset manipulation task is pivoting them. Datasets tend to be either long or wide. Generally, in the <code>tidyverse</code>, and certainly for <code>ggplot2</code>, we need long data. To go from one to the other we use <code>pivot_longer()</code> and <code>pivot_wider()</code> from <code>tidyr</code> <span class="citation" data-cites="citetidyr">(<a href="references.html#ref-citetidyr" role="doc-biblioref">Wickham 2021</a>)</span>.</p>
<p>We will create some wide data on whether ‘mark’ or ‘lauren’ won a running race in each of three years.</p>
<div class="cell">
<div class="sourceCode" id="cb187"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pivot_example_data <span class="ot">&lt;-</span> </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2021</span>),</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mark =</span> <span class="fu">c</span>(<span class="st">"first"</span>, <span class="st">"second"</span>, <span class="st">"first"</span>),</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">lauren =</span> <span class="fu">c</span>(<span class="st">"second"</span>, <span class="st">"first"</span>, <span class="st">"second"</span>))</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>pivot_example_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 3
   year mark   lauren
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
1  2019 first  second
2  2020 second first 
3  2021 first  second</code></pre>
</div>
</div>
<p>This dataset is in wide format at the moment. To get it into long format, we need a column that specifies the person, and another that specifies the result. We use <code>pivot_longer()</code> to achieve this.</p>
<div class="cell">
<div class="sourceCode" id="cb189"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>data_pivoted_longer <span class="ot">&lt;-</span> </span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>  pivot_example_data <span class="sc">|&gt;</span> </span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"mark"</span>, <span class="st">"lauren"</span>),</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_to =</span> <span class="st">"person"</span>,</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"position"</span>)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_pivoted_longer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 6 × 3
   year person position
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   
1  2019 mark   first   
2  2019 lauren second  
3  2020 mark   second  
4  2020 lauren first   
5  2021 mark   first   
6  2021 lauren second  </code></pre>
</div>
</div>
<p>Occasionally, we need to go from long data to wide data. We use <code>pivot_wider()</code> to do this.</p>
<div class="cell">
<div class="sourceCode" id="cb191"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>data_pivoted_wider <span class="ot">&lt;-</span> </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  data_pivoted_longer <span class="sc">|&gt;</span> </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"person"</span>,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values_from =</span> <span class="st">"position"</span>)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_pivoted_wider)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 3 × 3
   year mark   lauren
  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
1  2019 first  second
2  2020 second first 
3  2021 first  second</code></pre>
</div>
</div>
</section>
<section id="string-manipulation-and-stringr" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="string-manipulation-and-stringr"><span class="header-section-number">3.8.3</span> String manipulation and <code>stringr</code></h3>
<p>In R we often create a string with double quotes, although using single quotes works too. For instance <code>c("a", "b")</code> consists of two strings ‘a’ and ‘b’, that are contained in a character vector. There are a variety of ways to manipulate strings in R and we focus on <code>stringr</code> <span class="citation" data-cites="citestringr">(<a href="references.html#ref-citestringr" role="doc-biblioref">Wickham 2019b</a>)</span>. This is automatically loaded when we load the <code>tidyverse</code>.</p>
<p>If we want to look for whether a string contains certain content, then we can use <code>str_detect()</code>. And if we want to remove or change some particular content then we can use <code>str_remove()</code> or <code>str_replace()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb193"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>dataset_of_strings <span class="ot">&lt;-</span> </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"rohan alexander"</span>, </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"monica alexander"</span>, </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"edward alexander"</span>, </span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"hugo alexander"</span>)</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>dataset_of_strings <span class="sc">|&gt;</span> </span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_rohan =</span> <span class="fu">str_detect</span>(names, <span class="st">"rohan"</span>),</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">make_howlett =</span> <span class="fu">str_replace</span>(names, <span class="st">"alexander"</span>, <span class="st">"howlett"</span>),</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">remove_rohan =</span> <span class="fu">str_remove</span>(names, <span class="st">"rohan"</span>)</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 4
  names            is_rohan make_howlett   remove_rohan      
  &lt;chr&gt;            &lt;lgl&gt;    &lt;chr&gt;          &lt;chr&gt;             
1 rohan alexander  TRUE     rohan howlett  " alexander"      
2 monica alexander FALSE    monica howlett "monica alexander"
3 edward alexander FALSE    edward howlett "edward alexander"
4 hugo alexander   FALSE    hugo howlett   "hugo alexander"  </code></pre>
</div>
</div>
<p>There are a variety of other functions that are often especially useful in data cleaning. For instance, we can use <code>str_length()</code> to find out how long a string is, and <code>str_c()</code> to bring strings together.</p>
<div class="cell">
<div class="sourceCode" id="cb195"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>dataset_of_strings <span class="sc">|&gt;</span> </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">length_is =</span> <span class="fu">str_length</span>(<span class="at">string =</span> names),</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">name_and_length =</span> <span class="fu">str_c</span>(names, length_is, <span class="at">sep =</span> <span class="st">" - "</span>)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 3
  names            length_is name_and_length      
  &lt;chr&gt;                &lt;int&gt; &lt;chr&gt;                
1 rohan alexander         15 rohan alexander - 15 
2 monica alexander        16 monica alexander - 16
3 edward alexander        16 edward alexander - 16
4 hugo alexander          14 hugo alexander - 14  </code></pre>
</div>
</div>
<p>Finally, <code>separate()</code> from <code>tidyr</code>, although not part of <code>stringr</code>, is indispensable for string manipulation. It turns one character column into many.</p>
<div class="cell">
<div class="sourceCode" id="cb197"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>dataset_of_strings <span class="sc">|&gt;</span> </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> names,</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"first"</span>, <span class="st">"last"</span>),</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">" "</span>,</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code># A tibble: 4 × 3
  names            first  last     
  &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;    
1 rohan alexander  rohan  alexander
2 monica alexander monica alexander
3 edward alexander edward alexander
4 hugo alexander   hugo   alexander</code></pre>
</div>
</div>
</section>
<section id="factor-variables-and-forcats" class="level3" data-number="3.8.4">
<h3 data-number="3.8.4" class="anchored" data-anchor-id="factor-variables-and-forcats"><span class="header-section-number">3.8.4</span> Factor variables and <code>forcats</code></h3>
<p>A factor is a collection of strings that are categories. Sometimes there will be an inherent ordering. For instance, the days of the week have an order – Monday, Tuesday, Wednesday, … – which is not alphabetical. But there is no requirement for that to be the case, for instance gender: female, male, and other; or pregnancy status: pregnant or not pregnant. Factors feature prominently in base R. They can be useful because they ensure that only appropriate strings are allowed. For instance, if ‘days_of_the_week’ was a factor variable then ‘January’ would not be allowed. But they can add a great deal of complication, and so they have a less prominent role in <code>tidyverse</code>. Nonetheless taking advantage of factors is useful in certain circumstances. For instance, when plotting the days of the week we probably want them in the usual ordering than in the alphabetical ordering that would result if we had them as a character variable. While factors are built into base R, one <code>tidyverse</code> package that is especially useful when using factors is <code>forcats</code> <span class="citation" data-cites="citeforcats">(<a href="references.html#ref-citeforcats" role="doc-biblioref">Wickham 2020a</a>)</span>.</p>
<p>Sometimes we have a character vector, and we will want it ordered in a particular way. The default is that a character vector is ordered alphabetically, but we may not want that. For instance, the days of the week would look strange on a graph if they were alphabetically ordered: Friday, Monday, Saturday, Sunday, Thursday, Tuesday, and Wednesday!</p>
<p>The way to change the ordering is to change the variable from a character to a factor. We can use <code>fct_relevel()</code> from <code>forcats</code> <span class="citation" data-cites="citeforcats">(<a href="references.html#ref-citeforcats" role="doc-biblioref">Wickham 2020a</a>)</span> to specify an ordering.</p>
<div class="cell">
<div class="sourceCode" id="cb199"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">853</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>days_data <span class="ot">&lt;-</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">days =</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Monday"</span>,</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Tuesday"</span>,</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Wednesday"</span>,</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Thursday"</span>,</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Friday"</span>,</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Saturday"</span>,</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Sunday"</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">some_value =</span> <span class="fu">c</span>(<span class="fu">sample.int</span>(<span class="dv">100</span>, <span class="dv">7</span>))</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>days_data <span class="ot">&lt;-</span></span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>  days_data <span class="sc">|&gt;</span></span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">days_as_factor =</span> <span class="fu">factor</span>(days),</span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">days_as_factor =</span> <span class="fu">fct_relevel</span>(</span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a>      days,</span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Monday"</span>,</span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Tuesday"</span>,</span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Wednesday"</span>,</span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Thursday"</span>,</span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Friday"</span>,</span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Saturday"</span>,</span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sunday"</span></span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we can compare the results by graphing first with the original character vector on the x-axis, and then another graph with the factor vector on the x-axis.</p>
<div class="cell">
<div class="sourceCode" id="cb200"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>days_data <span class="sc">|&gt;</span> </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> days, <span class="at">y =</span> some_value)) <span class="sc">+</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>days_data <span class="sc">|&gt;</span> </span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> days_as_factor, <span class="at">y =</span> some_value)) <span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid" style="width:50.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="03-r_essentials_files/figure-html/unnamed-chunk-158-2.png" class="img-fluid" style="width:50.0%"></p>
</div>
</div>
</section>
</section>
<section id="exercises-and-tutorial" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="exercises-and-tutorial"><span class="header-section-number">3.9</span> Exercises and tutorial</h2>
<section id="exercises" class="level3" data-number="3.9.1">
<h3 data-number="3.9.1" class="anchored" data-anchor-id="exercises"><span class="header-section-number">3.9.1</span> Exercises</h3>
<ol type="1">
<li>What is R?
<ol type="a">
<li>A open-source statistical programming language</li>
<li>A programming language created by Guido van Rossum</li>
<li>A closed source statistical programming language</li>
<li>An integrated development environment (IDE)</li>
</ol></li>
<li>What are three advantages of R? What are three disadvantages?</li>
<li>What is R Studio?
<ol type="a">
<li>An integrated development environment (IDE).</li>
<li>A closed source paid program.</li>
<li>A programming language created by Guido van Rossum</li>
<li>A statistical programming language.</li>
</ol></li>
<li>What is the class of the output of <code>2 + 2</code> (pick one)?
<ol type="a">
<li>character</li>
<li>factor</li>
<li>numeric</li>
<li>date</li>
</ol></li>
<li>Say we had run: <code>my_name &lt;- 'Rohan'</code>. What would be the result of running <code>print(my_name)</code> (pick one)?
<ol type="a">
<li>‘Edward’</li>
<li>‘Monica’</li>
<li>‘Hugo’</li>
<li>‘Rohan’</li>
</ol></li>
<li>Say we had a dataset with two columns: ‘name’, and ‘age’. Which verb should we use to pick just ‘name’ (pick one)?
<ol type="a">
<li><code>tidyverse::select()</code></li>
<li><code>tidyverse::mutate()</code></li>
<li><code>tidyverse::filter()</code></li>
<li><code>tidyverse::rename()</code></li>
</ol></li>
<li>Say we had loaded <code>AustralianPoliticians</code> and <code>tidyverse</code> and then run the following code: <code>australian_politicians &lt;- AustralianPoliticians::get_auspol('all')</code>. How could we select all of the columns that end with ‘Name’ (pick one)?
<ol type="a">
<li><code>australian_politicians |&gt; select(contains("Name"))</code></li>
<li><code>australian_politicians |&gt; select(starts_with("Name"))</code></li>
<li><code>australian_politicians |&gt; select(matches("Name"))</code></li>
<li><code>australian_politicians |&gt; select(ends_with("Name"))</code></li>
</ol></li>
<li>Under what circumstances, in terms of the names of the columns, would the use of <code>contains()</code> potentially give different answers to using <code>ends_with()</code> in the above question?</li>
<li>Which of the following are not <code>tidyverse</code> verbs (pick one)?
<ol type="a">
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>arrange()</code></li>
<li><code>mutate()</code></li>
<li><code>visualize()</code></li>
</ol></li>
<li>Which function would make a new column (pick one)?
<ol type="a">
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>arrange()</code></li>
<li><code>mutate()</code></li>
<li><code>visualize()</code></li>
</ol></li>
<li>Which function would focus on particular rows (pick one)?
<ol type="a">
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>arrange()</code></li>
<li><code>mutate()</code></li>
<li><code>summarise()</code></li>
</ol></li>
<li>Which combination of two functions could provide a mean of a dataset, by sex (pick two)?
<ol type="a">
<li><code>summarise()</code></li>
<li><code>filter()</code></li>
<li><code>arrange()</code></li>
<li><code>mutate()</code></li>
<li><code>group_by()</code></li>
</ol></li>
<li>Assume a variable called ‘age’ is an integer. Which line of code would create a column that is its exponential (pick one)?
<ol type="a">
<li><code>mutate(exp_age = exponential(age))</code></li>
<li><code>mutate(exp_age = exponent(age))</code></li>
<li><code>mutate(exp_age = exp(age))</code></li>
<li><code>mutate(exp_age = expon(age))</code></li>
</ol></li>
<li>Assume a column called ‘age’. Which line of code could create a column that contains the value from five rows above?
<ol type="a">
<li><code>mutate(five_before = lag(age))</code></li>
<li><code>mutate(five_before = lead(age))</code></li>
<li><code>mutate(five_before = lag(age, n = 5))</code></li>
<li><code>mutate(five_before = lead(age, n = 5))</code></li>
</ol></li>
<li>What would be the output of <code>class('edward')</code> (pick one)?
<ol type="a">
<li>‘numeric’</li>
<li>‘character’</li>
<li>‘data.frame’</li>
<li>‘vector’</li>
</ol></li>
<li>Which function would enable us to draw once from three options ‘blue, white, red’, with 10 per cent probability on ‘blue’ and ‘white’, and the remainder on ‘red’?
<ol type="a">
<li><code>sample(c('blue', 'white', 'red'), prob = c(0.1, 0.1, 0.8))</code></li>
<li><code>sample(c('blue', 'white', 'red'), size = 1)</code></li>
<li><code>sample(c('blue', 'white', 'red'), size = 1, prob = c(0.8, 0.1, 0.1))</code></li>
<li><code>sample(c('blue', 'white', 'red'), size = 1, prob = c(0.1, 0.1, 0.8))</code></li>
</ol></li>
<li>Which code simulates 10,000 draws from a normal distribution with a mean of 27 and a standard deviation of 3 (pick one)?
<ol type="a">
<li><code>rnorm(10000, mean = 27, sd = 3)</code></li>
<li><code>rnorm(27, mean = 10000, sd = 3)</code></li>
<li><code>rnorm(3, mean = 10000, sd = 27)</code></li>
<li><code>rnorm(27, mean = 3, sd = 1000)</code></li>
</ol></li>
<li>What are the three key aspects of the grammar of graphics (select all)?
<ol type="a">
<li>data</li>
<li>aesthetics</li>
<li>type</li>
<li><code>geom_histogram()</code></li>
</ol></li>
</ol>
</section>
<section id="tutorial" class="level3" data-number="3.9.2">
<h3 data-number="3.9.2" class="anchored" data-anchor-id="tutorial"><span class="header-section-number">3.9.2</span> Tutorial</h3>
<blockquote class="blockquote">
<p>I think we should be suspicious when we find ourselves attracted to data—very, very thin and weak data—that seem to justify beliefs that have held great currency in lots of societies throughout history, in a way that is conducive to the oppression of large segments of the population</p>
<p>Amia Srinivasan, 22 September 2021</p>
</blockquote>
<p>Reflect on the quote from Amia Srinivasan, Chichele Professor of Social and Political Theory, All Souls College, Oxford, and <span class="citation" data-cites="datafeminism2020">D’Ignazio and Klein (<a href="references.html#ref-datafeminism2020" role="doc-biblioref">2020</a>)</span>, especially Chapter 6, and spend at least two pages discussing them in relation to a dataset that you are familiar with.</p>



<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-citeaustralianpoliticians" class="csl-entry" role="doc-biblioentry">
Alexander, Rohan, and Paul A. Hodgetts. 2021. <em>AustralianPoliticians: Provides Datasets about Australian Politicians</em>. <a href="https://CRAN.R-project.org/package=AustralianPoliticians">https://CRAN.R-project.org/package=AustralianPoliticians</a>.
</div>
<div id="ref-american1848code" class="csl-entry" role="doc-biblioentry">
Association, American Medical, and New York Academy of Medicine. 1848. <em>Code of Medical Ethics</em>. Academy of Medicine.
</div>
<div id="ref-bertrand2004emily" class="csl-entry" role="doc-biblioentry">
Bertrand, Marianne, and Sendhil Mullainathan. 2004. <span>“Are Emily and Greg More Employable Than Lakisha and Jamal? A Field Experiment on Labor Market Discrimination.”</span> <em>American Economic Review</em> 94 (4): 991–1013.
</div>
<div id="ref-brokowski2019crispr" class="csl-entry" role="doc-biblioentry">
Brokowski, Carolyn, and Mazhar Adli. 2019. <span>“CRISPR Ethics: Moral Considerations for Applications of a Powerful Tool.”</span> <em>Journal of Molecular Biology</em> 431 (1): 88–101.
</div>
<div id="ref-buja1996interactive" class="csl-entry" role="doc-biblioentry">
Buja, Andreas, Dianne Cook, and Deborah F Swayne. 1996. <span>“Interactive High-Dimensional Data Visualization.”</span> <em>Journal of Computational and Graphical Statistics</em> 5 (1): 78–99.
</div>
<div id="ref-datafeminism2020" class="csl-entry" role="doc-biblioentry">
D’Ignazio, Catherine, and Lauren F Klein. 2020. <em>Data Feminism</em>. Mit Press.
</div>
<div id="ref-hangartner2021monitoring" class="csl-entry" role="doc-biblioentry">
Hangartner, Dominik, Daniel Kopp, and Michael Siegenthaler. 2021. <span>“Monitoring Hiring Discrimination Through Online Recruitment Platforms.”</span> <em>Nature</em> 589 (7843): 572–76.
</div>
<div id="ref-kieranskitchen" class="csl-entry" role="doc-biblioentry">
Healy, Kieran. 2020. <em>The Kitchen Counter Observatory</em>. <a href="https://kieranhealy.org/blog/archives/2020/05/21/the-kitchen-counter-observatory/">https://kieranhealy.org/blog/archives/2020/05/21/the-kitchen-counter-observatory/</a>.
</div>
<div id="ref-keyes2019" class="csl-entry" role="doc-biblioentry">
Keyes, Os. 2019. <span>“Counting the Countless.”</span> <em>Real Life</em>. <a href="https://reallifemag.com/counting-the-countless/">https://reallifemag.com/counting-the-countless/</a>.
</div>
<div id="ref-citeaer" class="csl-entry" role="doc-biblioentry">
Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with <span>R</span></em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.
</div>
<div id="ref-citelabelled" class="csl-entry" role="doc-biblioentry">
Larmarange, Joseph. 2021. <em>Labelled: Manipulating Labelled Data</em>. <a href="https://CRAN.R-project.org/package=labelled">https://CRAN.R-project.org/package=labelled</a>.
</div>
<div id="ref-neufeld2002wernher" class="csl-entry" role="doc-biblioentry">
Neufeld, Michael J. 2002. <span>“Wernher von Braun, the SS, and Concentration Camp Labor: Questions of Moral, Political, and Criminal Responsibility.”</span> <em>German Studies Review</em> 25 (1): 57–78.
</div>
<div id="ref-citeoecdgdp" class="csl-entry" role="doc-biblioentry">
OECD. 2022. <em>Quarterly GDP</em>. <a href="https://data.oecd.org/gdp/quarterly-gdp.htm">https://data.oecd.org/gdp/quarterly-gdp.htm</a>.
</div>
<div id="ref-citeR" class="csl-entry" role="doc-biblioentry">
R Core Team. 2021. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Thieme2018" class="csl-entry" role="doc-biblioentry">
Thieme, Nick. 2018. <span>“R Generation.”</span> <em>Significance</em> 15 (4): 14–19. <a href="https://doi.org/10.1111/j.1740-9713.2018.01169.x">https://doi.org/10.1111/j.1740-9713.2018.01169.x</a>.
</div>
<div id="ref-wickham2014tidy" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (1): 1–23.
</div>
<div id="ref-citeggplot" class="csl-entry" role="doc-biblioentry">
———. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-advancedr" class="csl-entry" role="doc-biblioentry">
———. 2019a. <em>Advanced r</em>. CRC Press.
</div>
<div id="ref-citestringr" class="csl-entry" role="doc-biblioentry">
———. 2019b. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.
</div>
<div id="ref-citeforcats" class="csl-entry" role="doc-biblioentry">
———. 2020a. <em>Forcats: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://CRAN.R-project.org/package=forcats">https://CRAN.R-project.org/package=forcats</a>.
</div>
<div id="ref-tidyversewebsite" class="csl-entry" role="doc-biblioentry">
———. 2020b. <em>Tidyverse</em>. <a href="https://www.tidyverse.org/">https://www.tidyverse.org/</a>.
</div>
<div id="ref-citetidyr" class="csl-entry" role="doc-biblioentry">
———. 2021. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-citetidyverse" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019a. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="doc-biblioentry">
———, et al. 2019b. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-citedplyr" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2020. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-r4ds" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science</em>. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-citereadr" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, Jim Hester, and Jennifer Bryan. 2021. <em>Readr: Read Rectangular Text Data</em>. <a href="https://CRAN.R-project.org/package=readr">https://CRAN.R-project.org/package=readr</a>.
</div>
<div id="ref-citehaven" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Evan Miller. 2020. <em>Haven: Import and Export ’SPSS’, ’Stata’ and ’SAS’ Files</em>. <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a>.
</div>
</div>
</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-drinking_from_a_fire_hose.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Drinking from a fire hose</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-workflow.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reproducible workflows</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->


</body></html>